<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Data Manipulation Challenge</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="index_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="index_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap-d6a003b94517c951b2d65075d42fb01b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Data Manipulation Challenge</h1>
<p class="subtitle lead">A Mental Model for Method Chaining in Pandas</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="data-manipulation-challenge---a-mental-model-for-method-chaining-in-pandas" class="level1">
<h1>üîó Data Manipulation Challenge - A Mental Model for Method Chaining in Pandas</h1>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>üìä Challenge Requirements In Section <a href="#student-analysis-section">Student Analysis Section</a>
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Complete all discussion questions for the seven mental models (plus some extra requirements for higher grades)</li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>üéØ Note on Python Usage
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Recommended Workflow: Use Your Existing Virtual Environment</strong> If you completed the Tech Setup Challenge Part 2, you already have a virtual environment set up! Here‚Äôs how to use it for this new challenge:</p>
<ol type="1">
<li><strong>Clone this new challenge repository</strong> (see Getting Started section below)</li>
<li><strong>Open the cloned repository in Cursor</strong></li>
<li><strong>Set this project to use your existing Python interpreter:</strong>
<ul>
<li>Press <code>Ctrl+Shift+P</code> ‚Üí ‚ÄúPython: Select Interpreter‚Äù</li>
<li>Navigate to and choose the interpreter from your existing virtual environment (e.g., <code>your-previous-project/venv/Scripts/python.exe</code>)</li>
</ul></li>
<li><strong>Activate the environment in your terminal:</strong>
<ul>
<li>Open terminal in Cursor (`Ctrl + ``)</li>
<li>Navigate to your previous project folder where you have the <code>venv</code> folder</li>
<li><strong>üí° Pro tip:</strong> You can quickly navigate by typing <code>cd</code> followed by dragging the folder from your file explorer into the terminal</li>
<li>Activate using the appropriate command for your system:
<ul>
<li><strong>Windows Command Prompt:</strong> <code>venv\Scripts\activate</code></li>
<li><strong>Windows PowerShell:</strong> <code>.\venv\Scripts\Activate.ps1</code></li>
<li><strong>Mac/Linux:</strong> <code>source venv/bin/activate</code></li>
</ul></li>
<li>You should see <code>(venv)</code> at the beginning of your terminal prompt</li>
</ul></li>
<li><strong>Install additional packages if needed:</strong> <code>pip install pandas numpy matplotlib seaborn</code></li>
</ol>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warning</span>‚ö†Ô∏è Cloud Storage Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Avoid using Google Drive, OneDrive, or other cloud storage for Python projects!</strong> These services can cause issues with: - Package installations failing due to file locking - Virtual environment corruption - Slow performance during pip operations</p>
<p><strong>Best practice:</strong> Keep your Python projects in a local folder like <code>C:\Users\YourName\Documents\</code> or <code>~/Documents/</code> instead of cloud-synced folders.</p>
</div>
</div>
<p><strong>Alternative: Create a New Virtual Environment</strong> If you prefer a fresh environment, follow the Quarto documentation: <a href="https://quarto.org/docs/projects/virtual-environments.html">https://quarto.org/docs/projects/virtual-environments.html</a>. Be sure to follow the instructions to activate the environment, set it up as your default Python interpreter for the project, and install the necessary packages (e.g.&nbsp;pandas) for this challenge. For installing the packages, you can use the <code>pip install -r requirements.txt</code> command since you already have the requirements.txt file in your project. Some steps do take a bit of time, so be patient.</p>
<p><strong>Why This Works:</strong> Virtual environments are portable - you can use the same environment across multiple projects, and Cursor automatically activates it when you select the interpreter!</p>
</div>
</div>
<section id="the-problem-mastering-data-manipulation-through-method-chaining" class="level2">
<h2 class="anchored" data-anchor-id="the-problem-mastering-data-manipulation-through-method-chaining">The Problem: Mastering Data Manipulation Through Method Chaining</h2>
<p><strong>Core Question:</strong> How can we efficiently manipulate datasets using <code>pandas</code> method chaining to answer complex business questions?</p>
<p><strong>The Challenge:</strong> Real-world data analysis requires combining multiple data manipulation techniques in sequence. Rather than creating intermediate variables at each step, method chaining allows us to write clean, readable code that flows logically from one operation to the next.</p>
<p><strong>Our Approach:</strong> We‚Äôll work with ZappTech‚Äôs shipment data to answer critical business questions about service levels and cross-category orders, using the seven mental models of data manipulation through pandas method chaining.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warning</span>‚ö†Ô∏è AI Partnership Required
</div>
</div>
<div class="callout-body-container callout-body">
<p>This challenge pushes boundaries intentionally. You‚Äôll tackle problems that normally require weeks of study, but with Cursor AI as your partner (and your brain keeping it honest), you can accomplish more than you thought possible.</p>
<p><strong>The new reality:</strong> The four stages of competence are Ignorance ‚Üí Awareness ‚Üí Learning ‚Üí Mastery. AI lets us produce Mastery-level work while operating primarily in the Awareness stage. I focus on awareness training, you leverage AI for execution, and together we create outputs that used to require years of dedicated study.</p>
</div>
</div>
</section>
<section id="the-seven-mental-models-of-data-manipulation" class="level2">
<h2 class="anchored" data-anchor-id="the-seven-mental-models-of-data-manipulation">The Seven Mental Models of Data Manipulation</h2>
<p>The seven most important ways we manipulate datasets are:</p>
<ol type="1">
<li><strong>Assign:</strong> Add new variables with calculations and transformations</li>
<li><strong>Subset:</strong> Filter data based on conditions or select specific columns</li>
<li><strong>Drop:</strong> Remove unwanted variables or observations</li>
<li><strong>Sort:</strong> Arrange data by values or indices</li>
<li><strong>Aggregate:</strong> Summarize data using functions like mean, sum, count</li>
<li><strong>Merge:</strong> Combine information from multiple datasets</li>
<li><strong>Split-Apply-Combine:</strong> Group data and apply functions within groups</li>
</ol>
</section>
<section id="data-and-business-context" class="level2">
<h2 class="anchored" data-anchor-id="data-and-business-context">Data and Business Context</h2>
<p>We analyze ZappTech‚Äôs shipment data, which contains information about product deliveries across multiple categories. This dataset is ideal for our analysis because:</p>
<ul>
<li><strong>Real Business Questions:</strong> CEO wants to understand service levels and cross-category shopping patterns</li>
<li><strong>Multiple Data Sources:</strong> Requires merging shipment data with product category information</li>
<li><strong>Complex Relationships:</strong> Service levels may vary by product category, and customers may order across categories</li>
<li><strong>Method Chaining Practice:</strong> Perfect for demonstrating all seven mental models in sequence</li>
</ul>
</section>
<section id="data-loading-and-initial-exploration" class="level2">
<h2 class="anchored" data-anchor-id="data-loading-and-initial-exploration">Data Loading and Initial Exploration</h2>
<p>Let‚Äôs start by loading the ZappTech shipment data and understanding what we‚Äôre working with.</p>
<div id="load-data" class="cell" data-message="false" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime, timedelta</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the shipment data</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>shipments_df <span class="op">=</span> pd.read_csv(</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"https://raw.githubusercontent.com/flyaflya/persuasive/main/shipments.csv"</span>, </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    parse_dates<span class="op">=</span>[<span class="st">'plannedShipDate'</span>, <span class="st">'actualShipDate'</span>]</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Load product line data</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>product_line_df <span class="op">=</span> pd.read_csv(</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"https://raw.githubusercontent.com/flyaflya/persuasive/main/productLine.csv"</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Reduce dataset size for faster processing (4,000 rows instead of 96,805 rows)</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>shipments_df <span class="op">=</span> shipments_df.head(<span class="dv">4000</span>)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Shipments data shape:"</span>, shipments_df.shape)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Shipments data columns:"</span>, shipments_df.columns.tolist())</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">First few rows of shipments data:"</span>)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(shipments_df.head(<span class="dv">10</span>))</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span><span class="op">*</span><span class="dv">50</span>)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Product line data shape:"</span>, product_line_df.shape)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Product line data columns:"</span>, product_line_df.columns.tolist())</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">First few rows of product line data:"</span>)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(product_line_df.head(<span class="dv">10</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Shipments data shape: (4000, 5)

Shipments data columns: ['shipID', 'plannedShipDate', 'actualShipDate', 'partID', 'quantity']

First few rows of shipments data:
   shipID plannedShipDate actualShipDate       partID  quantity
0   10001      2013-11-06     2013-10-04  part92b16c5         6
1   10002      2013-10-15     2013-10-04   part66983b         2
2   10003      2013-10-25     2013-10-07  part8e36f25         1
3   10004      2013-10-14     2013-10-08  part30f5de0         1
4   10005      2013-10-14     2013-10-08  part9d64d35         6
5   10006      2013-10-14     2013-10-08  part6cd6167        15
6   10007      2013-10-14     2013-10-08  parta4d5fd1         2
7   10008      2013-10-14     2013-10-08  part08cadf5         1
8   10009      2013-10-14     2013-10-08  part5cc4989        10
9   10010      2013-10-14     2013-10-08  part912ae4c         1

==================================================
Product line data shape: (11997, 3)

Product line data columns: ['partID', 'productLine', 'prodCategory']

First few rows of product line data:
        partID productLine prodCategory
0  part00005ba      line4c      Liquids
1  part000b57d      line61     Machines
2  part00123bf      linec1  Marketables
3  part0021fc9      line61     Machines
4  part0027e86      line2f     Machines
5  part002ed95      line4c      Liquids
6  part0030856      lineb8     Machines
7  part0033dfd      line49      Liquids
8  part0037a2a      linea3  Marketables
9  part003caee      linea3  Marketables</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>üí° Understanding the Data
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Shipments Data:</strong> Contains individual line items for each shipment, including: - <code>shipID</code>: Unique identifier for each shipment - <code>partID</code>: Product identifier - <code>plannedShipDate</code>: When the shipment was supposed to go out - <code>actualShipDate</code>: When it actually shipped - <code>quantity</code>: How many units were shipped</p>
<p><strong>Product Category and Line Data:</strong> Contains product category information: - <code>partID</code>: Links to shipments data - <code>productLine</code>: The category each product belongs to - <code>prodCategory</code>: The category each product belongs to</p>
<p><strong>Business Questions We‚Äôll Answer:</strong> 1. Does service level (on-time shipments) vary across product categories? 2. How often do orders include products from more than one category?</p>
</div>
</div>
</section>
<section id="the-seven-mental-models-a-progressive-learning-journey" class="level2">
<h2 class="anchored" data-anchor-id="the-seven-mental-models-a-progressive-learning-journey">The Seven Mental Models: A Progressive Learning Journey</h2>
<p>Now we‚Äôll work through each of the seven mental models using method chaining, starting simple and building complexity.</p>
<section id="assign-adding-new-variables" class="level3">
<h3 class="anchored" data-anchor-id="assign-adding-new-variables">1. Assign: Adding New Variables</h3>
<p><strong>Mental Model:</strong> Create new columns with calculations and transformations.</p>
<p>Let‚Äôs start by calculating whether each shipment was late:</p>
<div id="mental-model-1-assign" class="cell" data-execution_count="2">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simple assignment - calculate if shipment was late</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>shipments_with_lateness <span class="op">=</span> (</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    shipments_df</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    .assign(</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>        is_late<span class="op">=</span><span class="kw">lambda</span> df: df[<span class="st">'actualShipDate'</span>] <span class="op">&gt;</span> df[<span class="st">'plannedShipDate'</span>],</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>        days_late<span class="op">=</span><span class="kw">lambda</span> df: (df[<span class="st">'actualShipDate'</span>] <span class="op">-</span> df[<span class="st">'plannedShipDate'</span>]).dt.days</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Added lateness calculations:"</span>)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(shipments_with_lateness[[<span class="st">'shipID'</span>, <span class="st">'plannedShipDate'</span>, <span class="st">'actualShipDate'</span>, <span class="st">'is_late'</span>, <span class="st">'days_late'</span>]].head())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Added lateness calculations:
   shipID plannedShipDate actualShipDate  is_late  days_late
0   10001      2013-11-06     2013-10-04    False        -33
1   10002      2013-10-15     2013-10-04    False        -11
2   10003      2013-10-25     2013-10-07    False        -18
3   10004      2013-10-14     2013-10-08    False         -6
4   10005      2013-10-14     2013-10-08    False         -6</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>üí° Method Chaining Tip for New Python Users
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Why use <code>lambda df:</code>?</strong> When chaining methods, we need to reference the current state of the dataframe. The <code>lambda df:</code> tells pandas ‚Äúuse the current dataframe in this calculation.‚Äù Without it, pandas would look for a variable called <code>df</code> that doesn‚Äôt exist.</p>
<p><strong>Alternative approach:</strong> You could also write this as separate steps, but method chaining keeps related operations together and makes the code more readable.</p>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>ü§î Discussion Questions: Assign Mental Model
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Question 1: Data Types and Date Handling</strong> - What is the <code>dtype</code> of the <code>actualShipDate</code> series? How can you find out using code?</p>
<ul>
<li>Why is it important that both <code>actualShipDate</code> and <code>plannedShipDate</code> have the same data type for comparison?</li>
</ul>
<p><strong>Question 2: String vs Date Comparison</strong> - Can you give an example where comparing two dates as strings would yield unintuitive results, e.g.&nbsp;what happens if you try to compare ‚Äú04-11-2025‚Äù and ‚Äú05-20-2024‚Äù as strings vs as dates?</p>
<p><strong>Question 3: Debug This Code</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This code has an error - can you spot it?</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>shipments_with_lateness <span class="op">=</span> (</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    shipments_df</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    .assign(</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>        is_late<span class="op">=</span><span class="kw">lambda</span> df: df[<span class="st">'actualShipDate'</span>] <span class="op">&gt;</span> df[<span class="st">'plannedShipDate'</span>],</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>        days_late<span class="op">=</span><span class="kw">lambda</span> df: (df[<span class="st">'actualShipDate'</span>] <span class="op">-</span> df[<span class="st">'plannedShipDate'</span>]).dt.days,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>        lateStatement<span class="op">=</span><span class="st">"Darn Shipment is Late"</span> <span class="cf">if</span> shipments_df[<span class="st">'is_late'</span>] <span class="cf">else</span> <span class="st">"Shipment is on Time"</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>What‚Äôs wrong with the <code>lateStatement</code> assignment and how would you fix it?</p>
</div>
</div>
<section id="briefly-give-answers-to-the-discussion-questions-in-this-section" class="level4">
<h4 class="anchored" data-anchor-id="briefly-give-answers-to-the-discussion-questions-in-this-section">Briefly Give Answers to the Discussion Questions In This Section</h4>
<blockquote class="blockquote">
<p>Answers to Question 1:</p>
</blockquote>
<div id="95437b95" class="cell" data-message="false" data-execution_count="3">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Data type of actualShipDate:"</span>, shipments_df[<span class="st">'actualShipDate'</span>].dtype)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data type of actualShipDate: datetime64[ns]</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Question 1a answer: The <code>dtype</code> of the <code>actualShipDate</code> series is <code>datetime64[ns]</code></p>
</blockquote>
<blockquote class="blockquote">
<p>Question 1b answer: Datetime objects are more precise and can be compared directly. Python has built-in Datetime functions for comparison which takes care of the date/time, leapyear differences.</p>
</blockquote>
<blockquote class="blockquote">
<p>Answers to Question 2:</p>
</blockquote>
<p>String comparison vs.&nbsp;Date comparison example:</p>
<div id="c6bb2cf1" class="cell" data-message="false" data-execution_count="4">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: Comparing "04-11-2025" and "05-20-2024"</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># STRING COMPARISON (alphabetical/lexicographic)</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>date_str1 <span class="op">=</span> <span class="st">"04-11-2025"</span>  <span class="co"># April 11, 2025</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>date_str2 <span class="op">=</span> <span class="st">"05-20-2024"</span>  <span class="co"># May 20, 2024</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">60</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"STRING COMPARISON (Character-by-character):"</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">60</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Date 1: </span><span class="sc">{</span>date_str1<span class="sc">}</span><span class="ss"> (April 11, 2025)"</span>)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Date 2: </span><span class="sc">{</span>date_str2<span class="sc">}</span><span class="ss"> (May 20, 2024)"</span>)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Is '</span><span class="sc">{</span>date_str1<span class="sc">}</span><span class="ss">' &gt; '</span><span class="sc">{</span>date_str2<span class="sc">}</span><span class="ss">'? </span><span class="sc">{</span>date_str1 <span class="op">&gt;</span> date_str2<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">‚ùå WRONG! String comparison says April 2025 comes BEFORE May 2024!"</span>)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   Why? Because '04' &lt; '05' when comparing characters left-to-right"</span>)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   It ignores that 2025 &gt; 2024"</span>)</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="co"># VS DATE COMPARISON</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>date1 <span class="op">=</span> pd.to_datetime(<span class="st">"2025-04-11"</span>)  <span class="co"># April 11, 2025</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>date2 <span class="op">=</span> pd.to_datetime(<span class="st">"2024-05-20"</span>)  <span class="co"># May 20, 2024</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span><span class="op">*</span><span class="dv">60</span>)</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"DATETIME COMPARISON:"</span>)</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">60</span>)</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Date 1: </span><span class="sc">{</span>date1<span class="sc">}</span><span class="ss"> (April 11, 2025)"</span>)</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Date 2: </span><span class="sc">{</span>date2<span class="sc">}</span><span class="ss"> (May 20, 2024)"</span>)</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Is </span><span class="sc">{</span>date1<span class="sc">}</span><span class="ss"> &gt; </span><span class="sc">{</span>date2<span class="sc">}</span><span class="ss">? </span><span class="sc">{</span>date1 <span class="op">&gt;</span> date2<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">‚úì CORRECT! Datetime comparison properly recognizes April 2025"</span>)</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  comes AFTER May 2024 (11 months later)"</span>)</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the actual time difference</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>time_diff <span class="op">=</span> date1 <span class="op">-</span> date2</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Time difference: </span><span class="sc">{</span>time_diff<span class="sc">.</span>days<span class="sc">}</span><span class="ss"> days (</span><span class="sc">{</span>time_diff<span class="sc">.</span>days <span class="op">//</span> <span class="dv">30</span><span class="sc">}</span><span class="ss"> months)"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>============================================================
STRING COMPARISON (Character-by-character):
============================================================
Date 1: 04-11-2025 (April 11, 2025)
Date 2: 05-20-2024 (May 20, 2024)

Is '04-11-2025' &gt; '05-20-2024'? False

‚ùå WRONG! String comparison says April 2025 comes BEFORE May 2024!
   Why? Because '04' &lt; '05' when comparing characters left-to-right
   It ignores that 2025 &gt; 2024

============================================================
DATETIME COMPARISON:
============================================================
Date 1: 2025-04-11 00:00:00 (April 11, 2025)
Date 2: 2024-05-20 00:00:00 (May 20, 2024)

Is 2025-04-11 00:00:00 &gt; 2024-05-20 00:00:00? True

‚úì CORRECT! Datetime comparison properly recognizes April 2025
  comes AFTER May 2024 (11 months later)

Time difference: 326 days (10 months)</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p><strong>Key Insight:</strong> String comparison only looks at character codes from left to right:</p>
</blockquote>
<ul>
<li>‚Äú04-11-2025‚Äù vs ‚Äú05-20-2024‚Äù</li>
<li>Compares: ‚Äò0‚Äô=‚Äò0‚Äô, ‚Äò4‚Äô&lt;‚Äò5‚Äô ‚Üí stops here and says ‚Äú04‚Ä¶‚Äù &lt; ‚Äú05‚Ä¶‚Äù</li>
<li>Result: WRONG chronological order!</li>
</ul>
<p>Datetime comparison understands calendar logic: - April 2025 is 11 months after May 2024 - Result: CORRECT order!</p>
<blockquote class="blockquote">
<p>Answers to Question 3:</p>
</blockquote>
<div id="2177839c" class="cell" data-execution_count="5">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Here is the fixed error code:</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>shipments_with_lateness_corrected <span class="op">=</span> (</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    shipments_df</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    .assign(</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>        is_late<span class="op">=</span><span class="kw">lambda</span> df: df[<span class="st">'actualShipDate'</span>] <span class="op">&gt;</span> df[<span class="st">'plannedShipDate'</span>],</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>        days_late<span class="op">=</span><span class="kw">lambda</span> df: (df[<span class="st">'actualShipDate'</span>] <span class="op">-</span> df[<span class="st">'plannedShipDate'</span>]).dt.days,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Fix: Use lambda to reference the DataFrame being created, and .apply() for row-by-row</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>        lateStatement<span class="op">=</span><span class="kw">lambda</span> df: df[<span class="st">'is_late'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="st">"Darn Shipment is Late"</span> <span class="cf">if</span> x <span class="cf">else</span>  <span class="st">"Shipment is on Time"</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Fixed code results and showing only late shipments:"</span>)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(shipments_with_lateness_corrected[[<span class="st">'shipID'</span>, <span class="st">'is_late'</span>, <span class="st">'days_late'</span>, <span class="st">'lateStatement'</span>]].loc[shipments_with_lateness_corrected[<span class="st">'is_late'</span>] <span class="op">==</span> <span class="va">True</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Fixed code results and showing only late shipments:
      shipID  is_late  days_late          lateStatement
776    10192     True          5  Darn Shipment is Late
777    10192     True          5  Darn Shipment is Late
778    10192     True          5  Darn Shipment is Late
779    10192     True          5  Darn Shipment is Late
780    10192     True          5  Darn Shipment is Late
...      ...      ...        ...                    ...
3896   10956     True         21  Darn Shipment is Late
3897   10956     True         21  Darn Shipment is Late
3898   10956     True         21  Darn Shipment is Late
3899   10956     True         21  Darn Shipment is Late
3997   11001     True         11  Darn Shipment is Late

[456 rows x 4 columns]</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p><strong>The Fix:</strong></p>
</blockquote>
<ul>
<li>Use <code>lambda df:</code> to reference the DataFrame being built</li>
<li>Use <code>.apply()</code> to evaluate the if/else for EACH row individually</li>
<li>Now each row gets the correct statement based on its own <code>is_late</code> value</li>
</ul>
<p>Questi ### 2. Subset: Querying Rows and Filtering Columns</p>
<p><strong>Mental Model:</strong> Query rows based on conditions and filter to keep specific columns.</p>
<p>Let‚Äôs query for only late shipments and filter to keep the columns we need:</p>
<div id="mental-model-2-subset" class="cell" data-execution_count="6">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Query rows for late shipments and filter to keep specific columns</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>late_shipments <span class="op">=</span> (</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    shipments_with_lateness</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    .query(<span class="st">'is_late == True'</span>)  <span class="co"># Query rows where is_late is True</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">filter</span>([<span class="st">'shipID'</span>, <span class="st">'partID'</span>, <span class="st">'plannedShipDate'</span>, <span class="st">'actualShipDate'</span>, <span class="st">'days_late'</span>])  <span class="co"># Filter to keep specific columns</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Found </span><span class="sc">{</span><span class="bu">len</span>(late_shipments)<span class="sc">}</span><span class="ss"> late shipments out of </span><span class="sc">{</span><span class="bu">len</span>(shipments_with_lateness)<span class="sc">}</span><span class="ss"> total"</span>)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Late shipments sample:"</span>)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(late_shipments.head())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Found 456 late shipments out of 4000 total

Late shipments sample:
     shipID       partID plannedShipDate actualShipDate  days_late
776   10192  part0164a70      2013-10-09     2013-10-14          5
777   10192  part9259836      2013-10-09     2013-10-14          5
778   10192  part4526c73      2013-10-09     2013-10-14          5
779   10192  partbb47e81      2013-10-09     2013-10-14          5
780   10192  part008482f      2013-10-09     2013-10-14          5</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>üîç Understanding the Methods
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong><code>.query()</code></strong>: Query rows based on conditions (like SQL WHERE clause)</li>
<li><strong><code>.filter()</code></strong>: Filter to keep specific columns by name</li>
<li><strong>Alternative</strong>: You could use <code>.loc[]</code> for more complex row querying, but <code>.query()</code> is often more readable</li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>ü§î Discussion Questions: Subset Mental Model
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Question 1: Query vs Boolean Indexing</strong> - What‚Äôs the difference between using <code>.query('is_late == True')</code> and <code>[df['is_late'] == True]</code>? - Which approach is more readable and why?</p>
<p><strong>Question 2: Additional Row Querying</strong> - Can you show an example of using a variable like <code>late_threshold</code> to query rows for shipments that are at least <code>late_threshold</code> days late, e.g.&nbsp;what if you wanted to query rows for shipments that are at least 5 days late?</p>
</div>
</div>
</section>
<section id="briefly-give-answers-to-the-discussion-questions-in-this-section-1" class="level4">
<h4 class="anchored" data-anchor-id="briefly-give-answers-to-the-discussion-questions-in-this-section-1">Briefly Give Answers to the Discussion Questions In This Section</h4>
<blockquote class="blockquote">
<p><strong>Answers to Question 1: Query vs Boolean Indexing</strong></p>
</blockquote>
<blockquote class="blockquote">
<p>What‚Äôs the difference between <code>.query('is_late == True')</code> and <code>[df['is_late'] == True]</code>?** Both methods filter rows, but they work differently:</p>
</blockquote>
<div id="541a2a70" class="cell" data-execution_count="7">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Method 1: Using .query() - SQL-like string syntax</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Method 1: Using .query()"</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>late_with_query <span class="op">=</span> (</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    shipments_with_lateness</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    .query(<span class="st">'is_late == True'</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">filter</span>([<span class="st">'shipID'</span>, <span class="st">'partID'</span>, <span class="st">'days_late'</span>])</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Found </span><span class="sc">{</span><span class="bu">len</span>(late_with_query)<span class="sc">}</span><span class="ss"> late shipments"</span>)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(late_with_query.head())</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span><span class="op">*</span><span class="dv">60</span>)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Method 2: Boolean indexing - Python syntax</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Method 2: Using boolean indexing with brackets"</span>)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>late_with_brackets <span class="op">=</span> shipments_with_lateness[shipments_with_lateness[<span class="st">'is_late'</span>] <span class="op">==</span> <span class="va">True</span>]</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>late_with_brackets <span class="op">=</span> late_with_brackets[[<span class="st">'shipID'</span>, <span class="st">'partID'</span>, <span class="st">'days_late'</span>]]</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Found </span><span class="sc">{</span><span class="bu">len</span>(late_with_brackets)<span class="sc">}</span><span class="ss"> late shipments"</span>)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(late_with_brackets.head())</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Results are identical:"</span>, late_with_query.shape <span class="op">==</span> late_with_brackets.shape)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Method 1: Using .query()
Found 456 late shipments
     shipID       partID  days_late
776   10192  part0164a70          5
777   10192  part9259836          5
778   10192  part4526c73          5
779   10192  partbb47e81          5
780   10192  part008482f          5

============================================================
Method 2: Using boolean indexing with brackets
Found 456 late shipments
     shipID       partID  days_late
776   10192  part0164a70          5
777   10192  part9259836          5
778   10192  part4526c73          5
779   10192  partbb47e81          5
780   10192  part008482f          5

Results are identical: True</code></pre>
</div>
</div>
<p><strong>Key Differences:</strong></p>
<ol type="1">
<li><strong>Syntax Style:</strong>
<ul>
<li><code>.query()</code>: Uses SQL-like string syntax: <code>'is_late == True'</code></li>
<li>Boolean indexing: Uses Python syntax: <code>df['is_late'] == True</code></li>
</ul></li>
<li><strong>Variable References:</strong>
<ul>
<li><code>.query()</code>: Can reference external variables with <code>@</code>: <code>.query('days_late &gt; @threshold')</code></li>
<li>Boolean indexing: Uses normal Python variables directly</li>
</ul></li>
<li><strong>Method Chaining:</strong>
<ul>
<li><code>.query()</code>: Chains naturally with pandas methods</li>
<li>Boolean indexing: Breaks the chain (requires brackets)</li>
</ul></li>
</ol>
<p><strong>Which approach is more readable?</strong></p>
<p><strong><code>.query()</code> is generally more readable for:</strong> - Method chaining workflows (keeps the flow going) - Complex conditions: <code>.query('is_late == True and days_late &gt; 5')</code> - SQL-familiar teams (similar to WHERE clauses) - Avoiding long, repeated DataFrame names</p>
<p>Example:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> (</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    df</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    .query(<span class="st">'is_late == True and days_late &gt; 5'</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">filter</span>([<span class="st">'shipID'</span>, <span class="st">'days_late'</span>])</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    .sort_values(<span class="st">'days_late'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Boolean indexing is better for:</strong> - Simple, one-time filters - Dynamic conditions built programmatically - Complex Python logic - Column names with spaces or special characters</p>
<p><strong>Recommendation:</strong> Use <code>.query()</code> for method chaining pipelines, use boolean indexing for quick one-off filters.</p>
<blockquote class="blockquote">
<p><strong>Answers to Question 2: Using Variables in Queries</strong></p>
</blockquote>
<p><strong>Example: Query rows for shipments that are at least 5 days late</strong></p>
<div id="215ccee4" class="cell" data-execution_count="8">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the threshold</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>late_threshold <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Method 1: Using .query() with @ to reference external variable</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>very_late_query <span class="op">=</span> (</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    shipments_with_lateness</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    .query(<span class="st">'days_late &gt;= @late_threshold'</span>)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">filter</span>([<span class="st">'shipID'</span>, <span class="st">'partID'</span>, <span class="st">'days_late'</span>])</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    .sort_values(<span class="st">'days_late'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Shipments at least </span><span class="sc">{</span>late_threshold<span class="sc">}</span><span class="ss"> days late (using .query()):"</span>)</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Count: </span><span class="sc">{</span><span class="bu">len</span>(very_late_query)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(very_late_query.head(<span class="dv">10</span>))</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span><span class="op">*</span><span class="dv">60</span>)</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Method 2: Using boolean indexing (no @ needed)</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>very_late_brackets <span class="op">=</span> (</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>    shipments_with_lateness[</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>        shipments_with_lateness[<span class="st">'days_late'</span>] <span class="op">&gt;=</span> late_threshold</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>    [[<span class="st">'shipID'</span>, <span class="st">'partID'</span>, <span class="st">'days_late'</span>]]</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>    .sort_values(<span class="st">'days_late'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Shipments at least </span><span class="sc">{</span>late_threshold<span class="sc">}</span><span class="ss"> days late (using boolean indexing):"</span>)</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Count: </span><span class="sc">{</span><span class="bu">len</span>(very_late_brackets)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(very_late_brackets.head(<span class="dv">10</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Shipments at least 5 days late (using .query()):
Count: 186
      shipID       partID  days_late
3883   10956  part04ef2f7         21
3891   10956  part1fedfcf         21
3879   10956  part54d1a21         21
3880   10956  part0666061         21
3881   10956  parta27d449         21
3882   10956  partc63f9bc         21
3884   10956  part4875f85         21
3885   10956  partb722d53         21
3886   10956  partc979912         21
3887   10956  partc653823         21

============================================================
Shipments at least 5 days late (using boolean indexing):
Count: 186
      shipID       partID  days_late
3883   10956  part04ef2f7         21
3891   10956  part1fedfcf         21
3879   10956  part54d1a21         21
3880   10956  part0666061         21
3881   10956  parta27d449         21
3882   10956  partc63f9bc         21
3884   10956  part4875f85         21
3885   10956  partb722d53         21
3886   10956  partc979912         21
3887   10956  partc653823         21</code></pre>
</div>
</div>
<p><strong>Key Point:</strong> When using <code>.query()</code>, you MUST use the <code>@</code> symbol before variable names (like <code>@late_threshold</code>). This tells pandas to look for a variable in your Python environment rather than a column name.</p>
<p><strong>More complex example with multiple conditions:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>min_days <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>max_days <span class="op">=</span> <span class="dv">15</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Using .query() with multiple variables</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> df.query(<span class="st">'@min_days &lt;= days_late &lt;= @max_days'</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Equivalent with boolean indexing</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> df[(df[<span class="st">'days_late'</span>] <span class="op">&gt;=</span> min_days) <span class="op">&amp;</span> (df[<span class="st">'days_late'</span>] <span class="op">&lt;=</span> max_days)]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="drop-removing-unwanted-data" class="level3">
<h3 class="anchored" data-anchor-id="drop-removing-unwanted-data">3. Drop: Removing Unwanted Data</h3>
<p><strong>Mental Model:</strong> Remove columns or rows you don‚Äôt need.</p>
<p>Let‚Äôs clean up our data by removing unnecessary columns:</p>
<div id="mental-model-3-drop" class="cell" data-execution_count="9">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a cleaner dataset by dropping unnecessary columns</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>clean_shipments <span class="op">=</span> (</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    shipments_with_lateness</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    .drop(columns<span class="op">=</span>[<span class="st">'quantity'</span>])  <span class="co"># Drop quantity column (not needed for our analysis)</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    .dropna(subset<span class="op">=</span>[<span class="st">'plannedShipDate'</span>, <span class="st">'actualShipDate'</span>])  <span class="co"># Remove rows with missing dates</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Cleaned dataset: </span><span class="sc">{</span><span class="bu">len</span>(clean_shipments)<span class="sc">}</span><span class="ss"> rows, </span><span class="sc">{</span><span class="bu">len</span>(clean_shipments.columns)<span class="sc">}</span><span class="ss"> columns"</span>)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Remaining columns:"</span>, clean_shipments.columns.tolist())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cleaned dataset: 4000 rows, 6 columns
Remaining columns: ['shipID', 'plannedShipDate', 'actualShipDate', 'partID', 'is_late', 'days_late']</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>ü§î Discussion Questions: Drop Mental Model
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Question 1: Drop vs Filter Strategies</strong> - What‚Äôs the difference between <code>.drop(columns=['quantity'])</code> and <code>.filter()</code> with a list of columns you want to keep? - When would you choose to drop columns vs filter to keep specific columns?</p>
<p><strong>Question 2: Handling Missing Data</strong> - What happens if you use <code>.dropna()</code> without specifying <code>subset</code>? How is this different from <code>.dropna(subset=['plannedShipDate', 'actualShipDate'])</code>? - Why might you want to be selective about which columns to check for missing values?</p>
</div>
</div>
<section id="briefly-give-answers-to-the-discussion-questions-in-this-section-2" class="level4">
<h4 class="anchored" data-anchor-id="briefly-give-answers-to-the-discussion-questions-in-this-section-2">Briefly Give Answers to the Discussion Questions In This Section</h4>
<blockquote class="blockquote">
<p><strong>Answers to Question 1: Drop vs Filter Strategies</strong></p>
</blockquote>
<p><strong>What‚Äôs the difference between <code>.drop(columns=['quantity'])</code> and <code>.filter()</code> with a list of columns you want to keep?</strong></p>
<p>These methods are opposites - one removes columns, the other keeps them:</p>
<div id="6b55a84a" class="cell" data-execution_count="10">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's see what columns we have in our clean_shipments dataset</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>shipments_with_lateness.columns.tolist()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>['shipID',
 'plannedShipDate',
 'actualShipDate',
 'partID',
 'quantity',
 'is_late',
 'days_late']</code></pre>
</div>
</div>
<div id="982c7e03" class="cell" data-execution_count="11">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's see what columns we have in our clean_shipments dataset</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>clean_shipments_columns <span class="op">=</span> shipments_with_lateness.copy()</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Original columns:"</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(clean_shipments_columns.columns.tolist())</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Total: </span><span class="sc">{</span><span class="bu">len</span>(clean_shipments_columns.columns)<span class="sc">}</span><span class="ss"> columns</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">60</span>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Method 1: DROP - Remove specific columns (specify what to remove)</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>dropped_result <span class="op">=</span> clean_shipments_columns.drop(columns<span class="op">=</span>[<span class="st">'quantity'</span>, <span class="st">'partID'</span>])</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Method 1: Using .drop(columns=['quantity', 'partID'])"</span>)</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Remaining columns:"</span>)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dropped_result.columns.tolist())</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Total: </span><span class="sc">{</span><span class="bu">len</span>(dropped_result.columns)<span class="sc">}</span><span class="ss"> columns"</span>)</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span><span class="op">*</span><span class="dv">60</span>)</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Method 2: FILTER - Keep specific columns (specify what to keep)</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>filtered_result <span class="op">=</span> clean_shipments_columns.<span class="bu">filter</span>([<span class="st">'shipID'</span>, <span class="st">'plannedShipDate'</span>, <span class="st">'actualShipDate'</span>, <span class="st">'is_late'</span>])</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Method 2: Using .filter(['shipID', 'plannedShipDate', 'actualShipDate', 'is_late'])"</span>)</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Kept columns:"</span>)</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(filtered_result.columns.tolist())</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Total: </span><span class="sc">{</span><span class="bu">len</span>(filtered_result.columns)<span class="sc">}</span><span class="ss"> columns"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Original columns:
['shipID', 'plannedShipDate', 'actualShipDate', 'partID', 'quantity', 'is_late', 'days_late']
Total: 7 columns

============================================================

Method 1: Using .drop(columns=['quantity', 'partID'])
Remaining columns:
['shipID', 'plannedShipDate', 'actualShipDate', 'is_late', 'days_late']
Total: 5 columns

============================================================

Method 2: Using .filter(['shipID', 'plannedShipDate', 'actualShipDate', 'is_late'])
Kept columns:
['shipID', 'plannedShipDate', 'actualShipDate', 'is_late']
Total: 4 columns</code></pre>
</div>
</div>
<p><strong>Key Differences:</strong></p>
<ol type="1">
<li><strong>Opposite Operations:</strong>
<ul>
<li><code>.drop(columns=[...])</code> - <strong>REMOVES</strong> the specified columns</li>
<li><code>.filter([...])</code> - <strong>KEEPS</strong> only the specified columns</li>
</ul></li>
<li><strong>Column Selection Logic:</strong>
<ul>
<li><code>.drop()</code> - ‚ÄúRemove these, keep everything else‚Äù</li>
<li><code>.filter()</code> - ‚ÄúKeep only these, remove everything else‚Äù</li>
</ul></li>
<li><strong>Syntax:</strong>
<ul>
<li><code>.drop(columns=['col1', 'col2'])</code> - note the <code>columns=</code> parameter</li>
<li><code>.filter(['col1', 'col2'])</code> - direct list of column names</li>
</ul></li>
</ol>
<div id="b364f404" class="cell" data-execution_count="12">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example showing they can achieve the same result</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Starting with these columns:"</span>, clean_shipments.columns.tolist())</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Scenario: I want to keep only shipID, plannedShipDate, actualShipDate</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Option A: Use .filter() to keep specific columns</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>keep_with_filter <span class="op">=</span> clean_shipments.<span class="bu">filter</span>([<span class="st">'shipID'</span>, <span class="st">'plannedShipDate'</span>, <span class="st">'actualShipDate'</span>])</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Option B: Use .drop() to remove unwanted columns</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>keep_with_drop <span class="op">=</span> clean_shipments.drop(columns<span class="op">=</span>[<span class="st">'partID'</span>, <span class="st">'is_late'</span>, <span class="st">'days_late'</span>])</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Result using .filter():"</span>, keep_with_filter.columns.tolist())</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Result using .drop():"</span>, keep_with_drop.columns.tolist())</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Both methods give same result:"</span>, keep_with_filter.columns.tolist() <span class="op">==</span> keep_with_drop.columns.tolist())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Starting with these columns: ['shipID', 'plannedShipDate', 'actualShipDate', 'partID', 'is_late', 'days_late']

Result using .filter(): ['shipID', 'plannedShipDate', 'actualShipDate']
Result using .drop(): ['shipID', 'plannedShipDate', 'actualShipDate']
Both methods give same result: True</code></pre>
</div>
</div>
<p><strong>When would you choose to drop columns vs filter to keep specific columns?</strong></p>
<p><strong>Use <code>.filter()</code> (keep specific columns) when:</strong> - You know exactly which few columns you need - Working with wide datasets (many columns) but only need a few - Creating focused reports or visualizations - The number of columns to KEEP is smaller than to DROP</p>
<p><strong>Use <code>.drop()</code> (remove specific columns) when:</strong> - ‚úÖ You want to keep most columns but remove just a few - ‚úÖ Removing redundant or unnecessary columns - ‚úÖ The number of columns to DROP is smaller than to KEEP - ‚úÖ You want to preserve all columns except specific ones</p>
<p><strong>Rule of Thumb:</strong> - <strong>Few columns needed?</strong> ‚Üí Use <code>.filter()</code> (specify what to keep) - <strong>Few columns unwanted?</strong> ‚Üí Use <code>.drop()</code> (specify what to remove) - <strong>Goal: Be explicit but minimize typing!</strong></p>
<blockquote class="blockquote">
<p><strong>Answers to Question 2: Handling Missing Data</strong></p>
</blockquote>
<p><strong>What happens if you use <code>.dropna()</code> without specifying <code>subset</code>?</strong></p>
<div id="bbff83ae" class="cell" data-execution_count="13">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's create a sample dataset with missing values to demonstrate</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>sample_data <span class="op">=</span> pd.DataFrame({</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'shipID'</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>],</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'plannedDate'</span>: [pd.Timestamp(<span class="st">'2024-01-01'</span>), pd.Timestamp(<span class="st">'2024-01-02'</span>), </span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>                    <span class="va">None</span>, pd.Timestamp(<span class="st">'2024-01-04'</span>), pd.Timestamp(<span class="st">'2024-01-05'</span>)],</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'actualDate'</span>: [pd.Timestamp(<span class="st">'2024-01-01'</span>), <span class="va">None</span>, </span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>                   pd.Timestamp(<span class="st">'2024-01-03'</span>), pd.Timestamp(<span class="st">'2024-01-04'</span>), </span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>                   pd.Timestamp(<span class="st">'2024-01-05'</span>)],</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'quantity'</span>: [<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="va">None</span>, <span class="dv">50</span>],</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'notes'</span>: [<span class="st">'ok'</span>, <span class="st">'ok'</span>, <span class="st">'ok'</span>, <span class="st">'ok'</span>, <span class="va">None</span>]</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Original data with missing values (None/NaN):"</span>)</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sample_data)</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Original row count: </span><span class="sc">{</span><span class="bu">len</span>(sample_data)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span><span class="op">*</span><span class="dv">60</span>)</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Method 1: .dropna() WITHOUT subset - removes ANY row with ANY missing value</span></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>strict_drop <span class="op">=</span> sample_data.dropna()</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Method 1: .dropna() without subset"</span>)</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"(Removes rows with missing values in ANY column)"</span>)</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(strict_drop)</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Remaining rows: </span><span class="sc">{</span><span class="bu">len</span>(strict_drop)<span class="sc">}</span><span class="ss"> (removed </span><span class="sc">{</span><span class="bu">len</span>(sample_data) <span class="op">-</span> <span class="bu">len</span>(strict_drop)<span class="sc">}</span><span class="ss"> rows)"</span>)</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span><span class="op">*</span><span class="dv">60</span>)</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Method 2: .dropna(subset=[...]) - only checks specific columns</span></span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>selective_drop <span class="op">=</span> sample_data.dropna(subset<span class="op">=</span>[<span class="st">'plannedDate'</span>, <span class="st">'actualDate'</span>])</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Method 2: .dropna(subset=['plannedDate', 'actualDate'])"</span>)</span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"(Only removes rows with missing values in these 2 columns)"</span>)</span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(selective_drop)</span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Remaining rows: </span><span class="sc">{</span><span class="bu">len</span>(selective_drop)<span class="sc">}</span><span class="ss"> (removed </span><span class="sc">{</span><span class="bu">len</span>(sample_data) <span class="op">-</span> <span class="bu">len</span>(selective_drop)<span class="sc">}</span><span class="ss"> rows)"</span>)</span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span><span class="op">*</span><span class="dv">60</span>)</span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Difference:"</span>)</span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"- Without subset: Kept </span><span class="sc">{</span><span class="bu">len</span>(strict_drop)<span class="sc">}</span><span class="ss"> rows (very strict!)"</span>)</span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"- With subset: Kept </span><span class="sc">{</span><span class="bu">len</span>(selective_drop)<span class="sc">}</span><span class="ss"> rows (more flexible)"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Original data with missing values (None/NaN):
   shipID plannedDate actualDate  quantity notes
0       1  2024-01-01 2024-01-01      10.0    ok
1       2  2024-01-02        NaT      20.0    ok
2       3         NaT 2024-01-03      30.0    ok
3       4  2024-01-04 2024-01-04       NaN    ok
4       5  2024-01-05 2024-01-05      50.0  None

Original row count: 5

============================================================

Method 1: .dropna() without subset
(Removes rows with missing values in ANY column)
   shipID plannedDate actualDate  quantity notes
0       1  2024-01-01 2024-01-01      10.0    ok
Remaining rows: 1 (removed 4 rows)

============================================================

Method 2: .dropna(subset=['plannedDate', 'actualDate'])
(Only removes rows with missing values in these 2 columns)
   shipID plannedDate actualDate  quantity notes
0       1  2024-01-01 2024-01-01      10.0    ok
3       4  2024-01-04 2024-01-04       NaN    ok
4       5  2024-01-05 2024-01-05      50.0  None
Remaining rows: 3 (removed 2 rows)

============================================================

Difference:
- Without subset: Kept 1 rows (very strict!)
- With subset: Kept 3 rows (more flexible)</code></pre>
</div>
</div>
<p><strong>Key Difference:</strong></p>
<ul>
<li><code>.dropna()</code> without <code>subset</code>: Removes rows with <strong>ANY</strong> missing value in <strong>ANY</strong> column (very aggressive!)</li>
<li><code>.dropna(subset=[cols])</code>: Removes rows only if missing values are in <strong>specified</strong> columns (more targeted)</li>
</ul>
<p><strong>Why might you want to be selective about which columns to check for missing values?</strong></p>
<p><strong>Reason 1: Different Columns Have Different Importance</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Critical columns: Must have values for analysis</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>.dropna(subset<span class="op">=</span>[<span class="st">'customerID'</span>, <span class="st">'orderDate'</span>, <span class="st">'amount'</span>])</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Optional columns: Missing is OK (like notes, comments)</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Don't check these columns!</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Reason 2: Preserve More Data</strong> - Some columns naturally have missing values (e.g., ‚Äúdiscount_code‚Äù only exists for discounted orders) - Dropping rows for optional missing data wastes good data!</p>
<p><strong>Reason 3: Business Logic Requirements</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For calculating late shipments, we NEED these dates:</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>.dropna(subset<span class="op">=</span>[<span class="st">'plannedShipDate'</span>, <span class="st">'actualShipDate'</span>])</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># But missing 'quantity' might be OK for some analyses</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Example from our case:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We only care about date columns for lateness calculation</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>clean_shipments <span class="op">=</span> (</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    shipments_with_lateness</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    .drop(columns<span class="op">=</span>[<span class="st">'quantity'</span>])</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>    .dropna(subset<span class="op">=</span>[<span class="st">'plannedShipDate'</span>, <span class="st">'actualShipDate'</span>])  <span class="co"># Only check dates!</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="co"># If we used .dropna() without subset, we might lose rows unnecessarily</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="co"># because of missing values in OTHER columns we don't even care about!</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Best Practice:</strong> Only drop rows for missing values in columns that are <strong>essential</strong> for your specific analysis!</p>
<blockquote class="blockquote">

</blockquote>
</section>
</section>
<section id="sort-arranging-data" class="level3">
<h3 class="anchored" data-anchor-id="sort-arranging-data">4. Sort: Arranging Data</h3>
<p><strong>Mental Model:</strong> Order data by values or indices.</p>
<p>Let‚Äôs sort by lateness to see the worst offenders:</p>
<div id="mental-model-4-sort" class="cell" data-execution_count="14">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort by days late (worst first)</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>sorted_by_lateness <span class="op">=</span> (</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    clean_shipments</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    .sort_values(<span class="st">'days_late'</span>, ascending<span class="op">=</span><span class="va">False</span>)  <span class="co"># Sort by days_late, highest first</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    .reset_index(drop<span class="op">=</span><span class="va">True</span>)  <span class="co"># Reset index to be sequential</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Shipments sorted by lateness (worst first):"</span>)</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sorted_by_lateness[[<span class="st">'shipID'</span>, <span class="st">'partID'</span>, <span class="st">'days_late'</span>, <span class="st">'is_late'</span>]].head(<span class="dv">10</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Shipments sorted by lateness (worst first):
   shipID       partID  days_late  is_late
0   10956  part795d1a4         21     True
1   10956  partf23fd1e         21     True
2   10956  partc653823         21     True
3   10956  partb6208b5         21     True
4   10956  parte820e31         21     True
5   10956  part50c6b9a         21     True
6   10956  part1fedfcf         21     True
7   10956  part3017fa1         21     True
8   10956  part66bb851         21     True
9   10956  partd5b19e4         21     True</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>ü§î Discussion Questions: Sort Mental Model
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Question 1: Sorting Strategies</strong> - What‚Äôs the difference between <code>ascending=False</code> and <code>ascending=True</code> in sorting? - How would you sort by multiple columns (e.g., first by <code>is_late</code>, then by <code>days_late</code>)?</p>
<p><strong>Question 2: Index Management</strong> - Why do we use <code>.reset_index(drop=True)</code> after sorting? - What happens to the original index when you sort? Why might this be problematic?</p>
</div>
</div>
<section id="briefly-give-answers-to-the-discussion-questions-in-this-section-3" class="level4">
<h4 class="anchored" data-anchor-id="briefly-give-answers-to-the-discussion-questions-in-this-section-3">Briefly Give Answers to the Discussion Questions In This Section</h4>
<blockquote class="blockquote">
<p><strong>Answers to Question 1: Sorting Strategies</strong></p>
</blockquote>
<p><strong>What‚Äôs the difference between <code>ascending=False</code> and <code>ascending=True</code> in sorting?</strong></p>
<p>The <code>ascending</code> parameter controls the direction of sorting:</p>
<div id="7ac2bb74" class="cell" data-execution_count="15">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's sort the clean_shipments data by days_late to see the difference</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Original order (first 10 rows):"</span>)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(clean_shipments[[<span class="st">'shipID'</span>, <span class="st">'days_late'</span>, <span class="st">'is_late'</span>]].head(<span class="dv">10</span>))</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span><span class="op">*</span><span class="dv">60</span>)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="co"># ascending=True: Sort from SMALLEST to LARGEST (default)</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>sorted_ascending <span class="op">=</span> (</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>    clean_shipments</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>    .sort_values(<span class="st">'days_late'</span>, ascending<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>    [[<span class="st">'shipID'</span>, <span class="st">'days_late'</span>, <span class="st">'is_late'</span>]]</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">ascending=True (Smallest to Largest):"</span>)</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sorted_ascending.head(<span class="dv">10</span>))</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"..."</span>)</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sorted_ascending.tail(<span class="dv">5</span>))</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span><span class="op">*</span><span class="dv">60</span>)</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a><span class="co"># ascending=False: Sort from LARGEST to SMALLEST</span></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>sorted_descending <span class="op">=</span> (</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>    clean_shipments</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>    .sort_values(<span class="st">'days_late'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>    [[<span class="st">'shipID'</span>, <span class="st">'days_late'</span>, <span class="st">'is_late'</span>]]</span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">ascending=False (Largest to Smallest):"</span>)</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sorted_descending.head(<span class="dv">10</span>))</span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"..."</span>)</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sorted_descending.tail(<span class="dv">5</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Original order (first 10 rows):
   shipID  days_late  is_late
0   10001        -33    False
1   10002        -11    False
2   10003        -18    False
3   10004         -6    False
4   10005         -6    False
5   10006         -6    False
6   10007         -6    False
7   10008         -6    False
8   10009         -6    False
9   10010         -6    False

============================================================

ascending=True (Smallest to Largest):
     shipID  days_late  is_late
0     10001        -33    False
308   10059        -25    False
309   10059        -25    False
310   10059        -25    False
311   10059        -25    False
312   10059        -25    False
313   10059        -25    False
314   10059        -25    False
307   10059        -25    False
315   10059        -25    False
...
      shipID  days_late  is_late
3884   10956         21     True
3883   10956         21     True
3882   10956         21     True
3890   10956         21     True
3892   10956         21     True

============================================================

ascending=False (Largest to Smallest):
      shipID  days_late  is_late
3894   10956         21     True
3898   10956         21     True
3887   10956         21     True
3888   10956         21     True
3889   10956         21     True
3890   10956         21     True
3891   10956         21     True
3892   10956         21     True
3893   10956         21     True
3895   10956         21     True
...
     shipID  days_late  is_late
318   10059        -25    False
317   10059        -25    False
316   10059        -25    False
315   10059        -25    False
0     10001        -33    False</code></pre>
</div>
</div>
<p><strong>Key Differences:</strong></p>
<ul>
<li><code>ascending=True</code> (default):
<ul>
<li>Numbers: 1, 2, 3, ‚Ä¶ (smallest first)</li>
<li>Dates: oldest first</li>
<li>Strings: A, B, C, ‚Ä¶ (alphabetical)</li>
<li><strong>Use for:</strong> Finding minimums, earliest dates, alphabetical lists</li>
</ul></li>
<li><code>ascending=False</code>:
<ul>
<li>Numbers: 100, 99, 98, ‚Ä¶ (largest first)</li>
<li>Dates: newest first</li>
<li>Strings: Z, Y, X, ‚Ä¶ (reverse alphabetical)</li>
<li><strong>Use for:</strong> Finding maximums, most recent dates, top performers</li>
</ul></li>
</ul>
<p><strong>Practical Examples:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find most delayed shipments (largest days_late first)</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>.sort_values(<span class="st">'days_late'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Find earliest shipments (oldest dates first)</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>.sort_values(<span class="st">'shipDate'</span>, ascending<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Rank by customer spending (highest spenders first)</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>.sort_values(<span class="st">'total_spent'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>How would you sort by multiple columns (e.g., first by <code>is_late</code>, then by <code>days_late</code>)?</strong></p>
<p>Use a <strong>list of column names</strong> in the order you want to sort:</p>
<div id="a021ae48" class="cell" data-execution_count="16">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Multi-column sorting: First by is_late, then by days_late</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort by multiple columns</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>multi_sorted <span class="op">=</span> (</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    clean_shipments</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    .sort_values([<span class="st">'is_late'</span>, <span class="st">'days_late'</span>], ascending<span class="op">=</span>[<span class="va">False</span>, <span class="va">False</span>])</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>    [[<span class="st">'shipID'</span>, <span class="st">'is_late'</span>, <span class="st">'days_late'</span>]]</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>    .reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"First by is_late (True first), then by days_late (largest first):"</span>)</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(multi_sorted.head(<span class="dv">15</span>))</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span><span class="op">*</span><span class="dv">60</span>)</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a><span class="co"># You can mix ascending directions!</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>mixed_sort <span class="op">=</span> (</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>    clean_shipments</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>    .sort_values([<span class="st">'is_late'</span>, <span class="st">'days_late'</span>], ascending<span class="op">=</span>[<span class="va">True</span>, <span class="va">False</span>])</span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>    [[<span class="st">'shipID'</span>, <span class="st">'is_late'</span>, <span class="st">'days_late'</span>]]</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>    .reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">First by is_late (False first), then by days_late (largest first):"</span>)</span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mixed_sort.head(<span class="dv">15</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Multi-column sorting: First by is_late, then by days_late

First by is_late (True first), then by days_late (largest first):
    shipID  is_late  days_late
0    10217     True         21
1    10956     True         21
2    10956     True         21
3    10956     True         21
4    10956     True         21
5    10956     True         21
6    10956     True         21
7    10956     True         21
8    10956     True         21
9    10956     True         21
10   10956     True         21
11   10956     True         21
12   10956     True         21
13   10956     True         21
14   10956     True         21

============================================================

First by is_late (False first), then by days_late (largest first):
    shipID  is_late  days_late
0    10193    False          0
1    10193    False          0
2    10193    False          0
3    10193    False          0
4    10193    False          0
5    10193    False          0
6    10193    False          0
7    10193    False          0
8    10193    False          0
9    10193    False          0
10   10193    False          0
11   10193    False          0
12   10193    False          0
13   10193    False          0
14   10193    False          0</code></pre>
</div>
</div>
<p><strong>Syntax for Multiple Column Sorting:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Same ascending direction for all columns</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>df.sort_values([<span class="st">'col1'</span>, <span class="st">'col2'</span>], ascending<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Different ascending directions for each column</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>df.sort_values([<span class="st">'col1'</span>, <span class="st">'col2'</span>], ascending<span class="op">=</span>[<span class="va">True</span>, <span class="va">False</span>])</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="co">#              First col ‚Üë        Second col ‚Üì</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>How it works:</strong> 1. <strong>Primary sort:</strong> Sort by the first column (<code>is_late</code>) 2. <strong>Secondary sort:</strong> Within each group of the first column, sort by the second column (<code>days_late</code>) 3. <strong>Continue‚Ä¶</strong> for additional columns if specified</p>
<p><strong>Real-world example:</strong></p>
<div id="6470e65a" class="cell" data-execution_count="17">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Business use case: Show late shipments first, ordered by severity</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>business_report <span class="op">=</span> (</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    clean_shipments</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    .sort_values(</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>        [<span class="st">'is_late'</span>, <span class="st">'days_late'</span>],</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>        ascending<span class="op">=</span>[<span class="va">False</span>, <span class="va">False</span>]  <span class="co"># Late first, worst delays first</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>    [[<span class="st">'shipID'</span>, <span class="st">'partID'</span>, <span class="st">'is_late'</span>, <span class="st">'days_late'</span>, <span class="st">'actualShipDate'</span>]]</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>    .head(<span class="dv">20</span>)</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Priority Report: Late shipments sorted by delay severity"</span>)</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(business_report)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Priority Report: Late shipments sorted by delay severity
      shipID       partID  is_late  days_late actualShipDate
1144   10217  part2081be9     True         21     2013-10-14
3879   10956  part54d1a21     True         21     2013-10-15
3880   10956  part0666061     True         21     2013-10-15
3881   10956  parta27d449     True         21     2013-10-15
3882   10956  partc63f9bc     True         21     2013-10-15
3883   10956  part04ef2f7     True         21     2013-10-15
3884   10956  part4875f85     True         21     2013-10-15
3885   10956  partb722d53     True         21     2013-10-15
3886   10956  partc979912     True         21     2013-10-15
3887   10956  partc653823     True         21     2013-10-15
3888   10956  partb6208b5     True         21     2013-10-15
3889   10956  parte820e31     True         21     2013-10-15
3890   10956  part50c6b9a     True         21     2013-10-15
3891   10956  part1fedfcf     True         21     2013-10-15
3892   10956  part3017fa1     True         21     2013-10-15
3893   10956  part66bb851     True         21     2013-10-15
3894   10956  part795d1a4     True         21     2013-10-15
3895   10956  partd5b19e4     True         21     2013-10-15
3896   10956  part98c1c48     True         21     2013-10-15
3897   10956  part82e69e9     True         21     2013-10-15</code></pre>
</div>
</div>
<p><strong>Common Multi-Column Sorting Patterns:</strong></p>
<ol type="1">
<li><p><strong>Group then rank:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by category, rank by score within each category</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>df.sort_values([<span class="st">'category'</span>, <span class="st">'score'</span>], ascending<span class="op">=</span>[<span class="va">True</span>, <span class="va">False</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
<li><p><strong>Prioritize issues:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Show errors first, then warnings, sorted by timestamp</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>df.sort_values([<span class="st">'severity'</span>, <span class="st">'timestamp'</span>], ascending<span class="op">=</span>[<span class="va">False</span>, <span class="va">True</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
<li><p><strong>Customer reporting:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort by customer name, then by order date (newest first)</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>df.sort_values([<span class="st">'customer_name'</span>, <span class="st">'order_date'</span>], ascending<span class="op">=</span>[<span class="va">True</span>, <span class="va">False</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
</ol>
<blockquote class="blockquote">
<p><strong>Answers to Question 2: Index Management</strong></p>
</blockquote>
<p><strong>Why do we use <code>.reset_index(drop=True)</code> after sorting?</strong></p>
<div id="6f3d1d02" class="cell" data-execution_count="18">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's see what happens to the index when we sort</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Original data (index is the row number):"</span>)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>sample <span class="op">=</span> clean_shipments[[<span class="st">'shipID'</span>, <span class="st">'days_late'</span>]].head(<span class="dv">10</span>)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sample)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Index: </span><span class="sc">{</span>sample<span class="sc">.</span>index<span class="sc">.</span>tolist()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span><span class="op">*</span><span class="dv">60</span>)</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a><span class="co"># After sorting WITHOUT reset_index</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>sorted_no_reset <span class="op">=</span> sample.sort_values(<span class="st">'days_late'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">After sorting WITHOUT reset_index:"</span>)</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sorted_no_reset)</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Index: </span><span class="sc">{</span>sorted_no_reset<span class="sc">.</span>index<span class="sc">.</span>tolist()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Notice: Index is out of order! [7, 5, 9, 8, 6, ...]"</span>)</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span><span class="op">*</span><span class="dv">60</span>)</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a><span class="co"># After sorting WITH reset_index(drop=True)</span></span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>sorted_with_reset <span class="op">=</span> sample.sort_values(<span class="st">'days_late'</span>, ascending<span class="op">=</span><span class="va">False</span>).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">After sorting WITH reset_index(drop=True):"</span>)</span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sorted_with_reset)</span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Index: </span><span class="sc">{</span>sorted_with_reset<span class="sc">.</span>index<span class="sc">.</span>tolist()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Much better: Index is sequential! [0, 1, 2, 3, 4, ...]"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Original data (index is the row number):
   shipID  days_late
0   10001        -33
1   10002        -11
2   10003        -18
3   10004         -6
4   10005         -6
5   10006         -6
6   10007         -6
7   10008         -6
8   10009         -6
9   10010         -6
Index: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]

============================================================

After sorting WITHOUT reset_index:
   shipID  days_late
3   10004         -6
4   10005         -6
5   10006         -6
6   10007         -6
7   10008         -6
8   10009         -6
9   10010         -6
1   10002        -11
2   10003        -18
0   10001        -33
Index: [3, 4, 5, 6, 7, 8, 9, 1, 2, 0]
Notice: Index is out of order! [7, 5, 9, 8, 6, ...]

============================================================

After sorting WITH reset_index(drop=True):
   shipID  days_late
0   10004         -6
1   10005         -6
2   10006         -6
3   10007         -6
4   10008         -6
5   10009         -6
6   10010         -6
7   10002        -11
8   10003        -18
9   10001        -33
Index: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
Much better: Index is sequential! [0, 1, 2, 3, 4, ...]</code></pre>
</div>
</div>
<p><strong>What happens to the original index when you sort?</strong></p>
<ul>
<li><strong>Before sorting:</strong> Index is usually 0, 1, 2, 3, 4, ‚Ä¶</li>
<li><strong>After sorting:</strong> Index follows the rows wherever they move!</li>
<li><strong>Result:</strong> Index becomes jumbled: 47, 12, 89, 3, 56, ‚Ä¶</li>
</ul>
<p><strong>Why might this be problematic?</strong></p>
<ol type="1">
<li><p><strong>Confusing when displaying data:</strong></p>
<pre><code>Index  shipID  days_late
47     10192   21
12     10956   21
89     10847   19    ‚Üê Index 89? Where's 0-88?</code></pre></li>
<li><p><strong>Breaks sequential operations:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>df.loc[<span class="dv">0</span>]  <span class="co"># Might not exist!</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>df.iloc[<span class="dv">0</span>]  <span class="co"># Gets first row (different from .loc[0])</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
<li><p><strong>Problems with iteration:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(df)):</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>    df.loc[i]  <span class="co"># May cause KeyError if index i doesn't exist!</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
</ol>
<p><strong>The Solution: <code>.reset_index(drop=True)</code></strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>df.sort_values(<span class="st">'column'</span>).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li><code>reset_index()</code>: Creates new sequential index (0, 1, 2, ‚Ä¶)</li>
<li><code>drop=True</code>: Discards the old index (don‚Äôt keep it as a new column)</li>
<li><code>drop=False</code>: Keeps old index as a new column (rarely needed)</li>
</ul>
<p><strong>When to use it:</strong> - ‚úÖ After sorting data for display - ‚úÖ When you need sequential access (.loc[0], .loc[1], ‚Ä¶) - ‚úÖ Before exporting sorted data - ‚úÖ When index values don‚Äôt matter (they‚Äôre just row numbers)</p>
<p><strong>When NOT to use it:</strong> - ‚ùå When index contains meaningful data (like datetime or IDs) - ‚ùå When you need to track original row positions - ‚ùå When joining dataframes on index</p>
<p><strong>Best Practice:</strong> Reset index after sorting unless you have a specific reason to keep the jumbled index!</p>
<blockquote class="blockquote">

</blockquote>
</section>
</section>
<section id="aggregate-summarizing-data" class="level3">
<h3 class="anchored" data-anchor-id="aggregate-summarizing-data">5. Aggregate: Summarizing Data</h3>
<p><strong>Mental Model:</strong> Calculate summary statistics across groups or the entire dataset.</p>
<p>Let‚Äôs calculate overall service level metrics:</p>
<div id="mental-model-5-aggregate" class="cell" data-execution_count="19">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate overall service level metrics</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>service_metrics <span class="op">=</span> (</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>    clean_shipments</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>    .agg({</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">'is_late'</span>: [<span class="st">'count'</span>, <span class="st">'sum'</span>, <span class="st">'mean'</span>],  <span class="co"># Count total, count late, calculate percentage</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">'days_late'</span>: [<span class="st">'mean'</span>, <span class="st">'max'</span>]  <span class="co"># Average and maximum days late</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">round</span>(<span class="dv">3</span>)</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Overall Service Level Metrics:"</span>)</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(service_metrics)</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate percentage on-time directly from the data</span></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>on_time_rate <span class="op">=</span> (<span class="dv">1</span> <span class="op">-</span> clean_shipments[<span class="st">'is_late'</span>].mean()) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">On-time delivery rate: </span><span class="sc">{</span>on_time_rate<span class="sc">:.1f}</span><span class="ss">%"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Overall Service Level Metrics:
        is_late  days_late
count  4000.000        NaN
sum     456.000        NaN
mean      0.114     -0.974
max         NaN     21.000

On-time delivery rate: 88.6%</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>ü§î Discussion Questions: Aggregate Mental Model
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Question 1: Boolean Aggregation</strong> - Why does <code>sum()</code> work on boolean values? What does it count?</p>
</div>
</div>
<section id="briefly-give-answers-to-the-discussion-questions-in-this-section-4" class="level4">
<h4 class="anchored" data-anchor-id="briefly-give-answers-to-the-discussion-questions-in-this-section-4">Briefly Give Answers to the Discussion Questions In This Section</h4>
<blockquote class="blockquote">
<p><strong>Answers to Question 1: Boolean Aggregation</strong></p>
</blockquote>
<div id="7914e364" class="cell" data-execution_count="20">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>clean_shipments.agg({</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>        <span class="st">'is_late'</span>: [<span class="st">'count'</span>, <span class="st">'sum'</span>, <span class="st">'mean'</span>]</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Total shipments: </span><span class="sc">{</span>clean_shipments[<span class="st">'is_late'</span>]<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Total late shipments: </span><span class="sc">{</span>clean_shipments<span class="sc">.</span>query(<span class="st">'is_late == True'</span>)<span class="sc">.</span><span class="bu">filter</span>([<span class="st">'is_late'</span>])<span class="sc">.</span>count()<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Total shipments: 456
Total late shipments: is_late    456
dtype: int64</code></pre>
</div>
</div>
<p><code>sum()</code> works on boolean values because it counts the number of True values in the series. See above example using sum and query for late shipments‚Äôs count. Botha re same result. ### 6. Merge: Combining Information</p>
<p><strong>Mental Model:</strong> Join data from multiple sources to create richer datasets.</p>
<p>Now let‚Äôs analyze service levels by product category. First, we need to merge our data:</p>
<div id="mental-model-6-merge-prep" class="cell" data-execution_count="21">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge shipment data with product line data</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>shipments_with_category <span class="op">=</span> (</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>    clean_shipments</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>    .merge(product_line_df, on<span class="op">=</span><span class="st">'partID'</span>, how<span class="op">=</span><span class="st">'left'</span>)  <span class="co"># Left join to keep all shipments</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>    .assign(</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>        category_late<span class="op">=</span><span class="kw">lambda</span> df: df[<span class="st">'is_late'</span>] <span class="op">&amp;</span> df[<span class="st">'prodCategory'</span>].notna()  <span class="co"># Only count as late if we have category info</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Product categories available:"</span>)</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(shipments_with_category[<span class="st">'prodCategory'</span>].value_counts())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Product categories available:
prodCategory
Marketables    1850
Machines        846
SpareParts      767
Liquids         537
Name: count, dtype: int64</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>ü§î Discussion Questions: Merge Mental Model
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Question 1: Join Types and Data Loss</strong> - Why does your professor think we should use <code>how='left'</code> in most cases? - How can you check if any shipments were lost during the merge?</p>
<p><strong>Question 2: Key Column Matching</strong> - What happens if there are duplicate <code>partID</code> values in the <code>product_line_df</code>?</p>
</div>
</div>
</section>
<section id="briefly-give-answers-to-the-discussion-questions-in-this-section-5" class="level4">
<h4 class="anchored" data-anchor-id="briefly-give-answers-to-the-discussion-questions-in-this-section-5">Briefly Give Answers to the Discussion Questions In This Section</h4>
<blockquote class="blockquote">
<p><strong>Answers to Question 1: Join Types and Data Loss</strong></p>
</blockquote>
<p><strong>Why does your professor think we should use <code>how='left'</code> in most cases?</strong></p>
<p>Using <code>how='left'</code> preserves ALL rows from your primary (left) dataset. It is like RDBMS left join.</p>
<div id="b864eab5" class="cell" data-execution_count="22">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare different join types</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Understanding Join Types:</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check sizes before merge</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"clean_shipments rows: </span><span class="sc">{</span><span class="bu">len</span>(clean_shipments)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"product_line_df rows: </span><span class="sc">{</span><span class="bu">len</span>(product_line_df)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a><span class="co"># LEFT JOIN - Keep ALL shipments</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>left_join <span class="op">=</span> clean_shipments.merge(product_line_df, on<span class="op">=</span><span class="st">'partID'</span>, how<span class="op">=</span><span class="st">'left'</span>)</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"LEFT JOIN:  </span><span class="sc">{</span><span class="bu">len</span>(left_join)<span class="sc">}</span><span class="ss"> rows (kept all shipments ‚úì)"</span>)</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a><span class="co"># INNER JOIN - Only matching rows</span></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>inner_join <span class="op">=</span> clean_shipments.merge(product_line_df, on<span class="op">=</span><span class="st">'partID'</span>, how<span class="op">=</span><span class="st">'inner'</span>)</span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"INNER JOIN: </span><span class="sc">{</span><span class="bu">len</span>(inner_join)<span class="sc">}</span><span class="ss"> rows (lost </span><span class="sc">{</span><span class="bu">len</span>(clean_shipments) <span class="op">-</span> <span class="bu">len</span>(inner_join)<span class="sc">}</span><span class="ss"> shipments ‚úó)"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Understanding Join Types:

clean_shipments rows: 4000
product_line_df rows: 11997

LEFT JOIN:  4000 rows (kept all shipments ‚úì)
INNER JOIN: 4000 rows (lost 0 shipments ‚úó)</code></pre>
</div>
</div>
<p><strong>Why LEFT join is best:</strong> 1. <strong>Preserves your main dataset</strong> - Don‚Äôt lose shipments just because category data is missing. Same as RDMBS join we are using in old days. 2. <strong>Prevents data loss</strong> - INNER join drops rows without telling you but here all core database rows intact. 3. <strong>Shows missing data</strong> - Can see which shipments lack category info (NaN values) 4. <strong>Matches business logic</strong> - ‚ÄúGive me all shipments, with category if available‚Äù</p>
<p><strong>How can you check if any shipments were lost during the merge?</strong></p>
<div id="83b270ab" class="cell" data-execution_count="23">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Checking for data loss:</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Method 1: Compare row counts</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>rows_before <span class="op">=</span> <span class="bu">len</span>(clean_shipments)</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>rows_after <span class="op">=</span> <span class="bu">len</span>(shipments_with_category)</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Method 1: Row count comparison"</span>)</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Before: </span><span class="sc">{</span>rows_before<span class="sc">}</span><span class="ss"> rows"</span>)</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  After:  </span><span class="sc">{</span>rows_after<span class="sc">}</span><span class="ss"> rows"</span>)</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Lost:   </span><span class="sc">{</span>rows_before <span class="op">-</span> rows_after<span class="sc">}</span><span class="ss"> rows"</span>)</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  ‚úì All preserved!"</span> <span class="cf">if</span> rows_before <span class="op">==</span> rows_after <span class="cf">else</span> <span class="ss">f"  ‚úó Lost </span><span class="sc">{</span>rows_before <span class="op">-</span> rows_after<span class="sc">}</span><span class="ss"> rows!"</span>)</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Method 2: Check for missing values</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>missing <span class="op">=</span> shipments_with_category[<span class="st">'prodCategory'</span>].isna().<span class="bu">sum</span>()</span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Method 2: Missing category data"</span>)</span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Shipments with NaN category: </span><span class="sc">{</span>missing<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> missing <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  ‚úì LEFT join preserved these </span><span class="sc">{</span>missing<span class="sc">}</span><span class="ss"> shipments"</span>)</span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Method 3: Verify unique IDs</span></span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Method 3: Unique shipment verification"</span>)</span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Unique before: </span><span class="sc">{</span>clean_shipments[<span class="st">'shipID'</span>]<span class="sc">.</span>nunique()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Unique after:  </span><span class="sc">{</span>shipments_with_category[<span class="st">'shipID'</span>]<span class="sc">.</span>nunique()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  ‚úì Match!"</span> <span class="cf">if</span> clean_shipments[<span class="st">'shipID'</span>].nunique() <span class="op">==</span> shipments_with_category[<span class="st">'shipID'</span>].nunique() <span class="cf">else</span> <span class="st">"  ‚úó Mismatch!"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Checking for data loss:

Method 1: Row count comparison
  Before: 4000 rows
  After:  4000 rows
  Lost:   0 rows
  ‚úì All preserved!

Method 2: Missing category data
  Shipments with NaN category: 0

Method 3: Unique shipment verification
  Unique before: 997
  Unique after:  997
  ‚úì Match!</code></pre>
</div>
</div>
<p><strong>Best practice validation:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Always check after merge!</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> <span class="bu">len</span>(df_after) <span class="op">==</span> <span class="bu">len</span>(df_before), <span class="st">"Data loss!"</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Missing data: </span><span class="sc">{</span>df_after[<span class="st">'new_col'</span>]<span class="sc">.</span>isna()<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<blockquote class="blockquote">
<p><strong>Answers to Question 2: Key Column Matching</strong></p>
</blockquote>
<p><strong>What happens if there are duplicate <code>partID</code> values in the <code>product_line_df</code>?</strong></p>
<div id="068d8055" class="cell" data-execution_count="24">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for duplicates in the product_line_df</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Checking for duplicate partIDs in product_line_df:</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>duplicate_count <span class="op">=</span> product_line_df[<span class="st">'partID'</span>].duplicated().<span class="bu">sum</span>()</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Duplicate partIDs: </span><span class="sc">{</span>duplicate_count<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> duplicate_count <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">‚ö†Ô∏è  WARNING: Duplicates found!"</span>)</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"This will create multiple rows for each shipment!"</span>)</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Show an example</span></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>    dup_parts <span class="op">=</span> product_line_df[product_line_df[<span class="st">'partID'</span>].duplicated(keep<span class="op">=</span><span class="va">False</span>)].sort_values(<span class="st">'partID'</span>)</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Example duplicates:"</span>)</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(dup_parts.head(<span class="dv">10</span>))</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"‚úì No duplicates - each partID is unique"</span>)</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"This is good: 1-to-1 mapping between parts and categories"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Checking for duplicate partIDs in product_line_df:

Duplicate partIDs: 0
‚úì No duplicates - each partID is unique
This is good: 1-to-1 mapping between parts and categories</code></pre>
</div>
</div>
<p><strong>What happens with duplicates:</strong></p>
<p>If <code>product_line_df</code> has duplicate <code>partID</code> values, the merge will create <strong>multiple rows</strong> for each shipment:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example:</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>clean_shipments:         product_line_df:        Result after merge:</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>shipID  partID          partID  category         shipID  partID  category</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="dv">10001</span>   A123            A123    Electronics      <span class="dv">10001</span>   A123    Electronics</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>                        A123    Accessories      <span class="dv">10001</span>   A123    Accessories  ‚Üê Duplicate<span class="op">!</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Result:</strong> 1 shipment becomes 2 rows! This inflates your data and ruins aggregations.</p>
<p><strong>How to prevent:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove duplicates before merge</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>product_line_clean <span class="op">=</span> product_line_df.drop_duplicates(subset<span class="op">=</span>[<span class="st">'partID'</span>])</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Or check first</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> product_line_df[<span class="st">'partID'</span>].is_unique, <span class="st">"Duplicates found!"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="split-apply-combine-group-analysis" class="level3">
<h3 class="anchored" data-anchor-id="split-apply-combine-group-analysis">7. Split-Apply-Combine: Group Analysis</h3>
<p><strong>Mental Model:</strong> Group data and apply functions within each group.</p>
<p>Now let‚Äôs analyze service levels by category:</p>
<div id="mental-model-7-groupby" class="cell" data-execution_count="25">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Analyze service levels by product category</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>service_by_category <span class="op">=</span> (</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>    shipments_with_category</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>    .groupby(<span class="st">'prodCategory'</span>)  <span class="co"># Split by product category</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>    .agg({</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">'is_late'</span>: [<span class="st">'any'</span>, <span class="st">'count'</span>, <span class="st">'sum'</span>, <span class="st">'mean'</span>],  <span class="co"># Count, late count, percentage late</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">'days_late'</span>: [<span class="st">'mean'</span>, <span class="st">'max'</span>]  <span class="co"># Average and max days late</span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">round</span>(<span class="dv">3</span>)</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Service Level by Product Category:"</span>)</span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(service_by_category)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Service Level by Product Category:
             is_late                   days_late    
                 any count  sum   mean      mean max
prodCategory                                        
Liquids         True   537   22  0.041    -0.950  19
Machines        True   846  152  0.180    -1.336  21
Marketables     True  1850  145  0.078    -0.804  21
SpareParts      True   767  137  0.179    -1.003  21</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>ü§î Discussion Questions: Split-Apply-Combine Mental Model
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Question 1: GroupBy Mechanics</strong> - What does <code>.groupby('prodCategory')</code> actually do? How does it ‚Äúsplit‚Äù the data? - Why do we need to use <code>.agg()</code> after grouping? What happens if you don‚Äôt?</p>
<p><strong>Question 2: Multi-Level Grouping</strong> - Explore grouping by <code>['shipID', 'prodCategory']</code>? What question does this answer versus grouping by <code>'prodCategory'</code> alone? (HINT: There may be many rows with identical shipID‚Äôs due to a particular order having multiple partID‚Äôs.)</p>
</div>
</div>
<section id="briefly-give-answers-to-the-discussion-questions-in-this-section-6" class="level4">
<h4 class="anchored" data-anchor-id="briefly-give-answers-to-the-discussion-questions-in-this-section-6">Briefly Give Answers to the Discussion Questions In This Section</h4>
<blockquote class="blockquote">
<p><strong>Answers to Question 1: GroupBy Mechanics</strong></p>
</blockquote>
<p><strong>What does <code>.groupby('prodCategory')</code> actually do? How does it ‚Äúsplit‚Äù the data?</strong></p>
<p><code>.groupby()</code> divides your DataFrame into separate groups based on unique values in the specified column(s). see below example.</p>
<div id="2e2098e4" class="cell" data-execution_count="26">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's see what groupby does step by step</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Understanding GroupBy:</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="co"># First, see what categories we have</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Unique product categories:"</span>)</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(shipments_with_category[<span class="st">'prodCategory'</span>].value_counts())</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a><span class="co"># When we groupby, it creates separate groups for each category</span></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>grouped <span class="op">=</span> shipments_with_category.groupby(<span class="st">'prodCategory'</span>)</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Type of grouped object: </span><span class="sc">{</span><span class="bu">type</span>(grouped)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Number of groups: </span><span class="sc">{</span>grouped<span class="sc">.</span>ngroups<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Group names (keys): </span><span class="sc">{</span><span class="bu">list</span>(grouped.groups.keys())<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Look at one group</span></span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">60</span>)</span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Example: Looking at the 'Liquids' group"</span>)</span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>liquids_group <span class="op">=</span> grouped.get_group(<span class="st">'Liquids'</span>)</span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Rows in Liquids group: </span><span class="sc">{</span><span class="bu">len</span>(liquids_group)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(liquids_group[[<span class="st">'shipID'</span>, <span class="st">'partID'</span>, <span class="st">'prodCategory'</span>, <span class="st">'is_late'</span>]].head())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Understanding GroupBy:

Unique product categories:
prodCategory
Marketables    1850
Machines        846
SpareParts      767
Liquids         537
Name: count, dtype: int64

Type of grouped object: &lt;class 'pandas.core.groupby.generic.DataFrameGroupBy'&gt;
Number of groups: 4
Group names (keys): ['Liquids', 'Machines', 'Marketables', 'SpareParts']

============================================================
Example: Looking at the 'Liquids' group
Rows in Liquids group: 537
     shipID       partID prodCategory  is_late
85    10017  part8100a77      Liquids    False
99    10019  partefbe62f      Liquids    False
116   10023  partd23422f      Liquids    False
121   10026  parta994851      Liquids    False
122   10027  partc6c0230      Liquids    False</code></pre>
</div>
</div>
<p><strong>How it ‚Äúsplits‚Äù the data:</strong></p>
<ol type="1">
<li><strong>Identifies unique values</strong> in the groupby column</li>
<li><strong>Separates rows</strong> into groups based on those values</li>
<li><strong>Creates a GroupBy object</strong> (not a DataFrame yet!)</li>
</ol>
<div id="29308d04" class="cell" data-execution_count="27">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visual demonstration of the split</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Visual representation of how data is split:</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> category, group <span class="kw">in</span> grouped:</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>category<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">len</span>(group)<span class="sc">}</span><span class="ss"> rows"</span>)</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  Late shipments: </span><span class="sc">{</span>group[<span class="st">'is_late'</span>]<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  On-time rate: </span><span class="sc">{</span>(<span class="dv">1</span> <span class="op">-</span> group[<span class="st">'is_late'</span>].mean()) <span class="op">*</span> <span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">%"</span>)</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Visual representation of how data is split:

Liquids: 537 rows
  Late shipments: 22
  On-time rate: 95.9%

Machines: 846 rows
  Late shipments: 152
  On-time rate: 82.0%

Marketables: 1850 rows
  Late shipments: 145
  On-time rate: 92.2%

SpareParts: 767 rows
  Late shipments: 137
  On-time rate: 82.1%
</code></pre>
</div>
</div>
<p><strong>Think of it like this:</strong></p>
<pre><code>Original DataFrame:          After .groupby('prodCategory'):
shipID  prodCategory         
10001   Liquids              Group 1: Liquids
10002   Machines             ‚îú‚îÄ All rows with 'Liquids'
10003   Liquids              
10004   Machines             Group 2: Machines
10005   Liquids              ‚îú‚îÄ All rows with 'Machines'
                             
                             Group 3: Marketables
                             ‚îú‚îÄ All rows with 'Marketables'
                             
                             Group 4: SpareParts
                             ‚îú‚îÄ All rows with 'SpareParts'</code></pre>
<p><strong>Why do we need to use <code>.agg()</code> after grouping? What happens if you don‚Äôt?</strong></p>
<p><code>.groupby()</code> alone just organizes the data - it doesn‚Äôt calculate anything! You need <code>.agg()</code> to tell it WHAT to calculate for each group.</p>
<div id="d556cb91" class="cell" data-execution_count="28">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Understanding why we need .agg():</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Just groupby - creates a GroupBy object</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>just_grouped <span class="op">=</span> shipments_with_category.groupby(<span class="st">'prodCategory'</span>)</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"1. Just .groupby(): </span><span class="sc">{</span><span class="bu">type</span>(just_grouped)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   This is NOT a DataFrame - it's a GroupBy object"</span>)</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   You can't display it or use it directly!"</span>)</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Try to print it (won't show data)</span></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"2. Trying to use just_grouped directly:"</span>)</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   </span><span class="sc">{</span>just_grouped<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   See? Just shows it's a GroupBy object, not the data!"</span>)</span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Use .agg() to get actual results</span></span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"3. Using .agg() to calculate statistics:"</span>)</span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a>with_agg <span class="op">=</span> just_grouped.agg({</span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">'is_late'</span>: [<span class="st">'count'</span>, <span class="st">'sum'</span>, <span class="st">'mean'</span>]</span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb74-21"><a href="#cb74-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(with_agg)</span>
<span id="cb74-22"><a href="#cb74-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">   NOW we have a DataFrame with actual results!"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Understanding why we need .agg():

1. Just .groupby(): &lt;class 'pandas.core.groupby.generic.DataFrameGroupBy'&gt;
   This is NOT a DataFrame - it's a GroupBy object
   You can't display it or use it directly!

2. Trying to use just_grouped directly:
   &lt;pandas.core.groupby.generic.DataFrameGroupBy object at 0x151a6d310&gt;
   See? Just shows it's a GroupBy object, not the data!

3. Using .agg() to calculate statistics:
             is_late               
               count  sum      mean
prodCategory                       
Liquids          537   22  0.040968
Machines         846  152  0.179669
Marketables     1850  145  0.078378
SpareParts       767  137  0.178618

   NOW we have a DataFrame with actual results!</code></pre>
</div>
</div>
<p><strong>What happens if you don‚Äôt use <code>.agg()</code>?</strong></p>
<div id="d98cf27a" class="cell" data-execution_count="29">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Options after .groupby():</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>grouped <span class="op">=</span> shipments_with_category.groupby(<span class="st">'prodCategory'</span>)</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Option 1: Use specific aggregation methods directly</span></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Option 1: Direct aggregation methods"</span>)</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(grouped[<span class="st">'is_late'</span>].<span class="bu">sum</span>())  <span class="co"># Works! Shortcut for .agg('sum')</span></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Option 2: Use .agg() for multiple calculations</span></span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Option 2: Use .agg() for complex aggregations"</span>)</span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> grouped.agg({</span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'is_late'</span>: [<span class="st">'count'</span>, <span class="st">'sum'</span>, <span class="st">'mean'</span>],</span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'days_late'</span>: [<span class="st">'mean'</span>, <span class="st">'max'</span>]</span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Option 3: Try to use grouped object without aggregation</span></span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Option 3: Try to print grouped object without aggregation"</span>)</span>
<span id="cb76-21"><a href="#cb76-21" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb76-22"><a href="#cb76-22" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(grouped)  <span class="co"># Just shows the object type</span></span>
<span id="cb76-23"><a href="#cb76-23" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb76-24"><a href="#cb76-24" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Error: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Options after .groupby():

Option 1: Direct aggregation methods
prodCategory
Liquids         22
Machines       152
Marketables    145
SpareParts     137
Name: is_late, dtype: int64

Option 2: Use .agg() for complex aggregations
             is_late                days_late    
               count  sum      mean      mean max
prodCategory                                     
Liquids          537   22  0.040968 -0.949721  19
Machines         846  152  0.179669 -1.335697  21
Marketables     1850  145  0.078378 -0.803784  21
SpareParts       767  137  0.178618 -1.002608  21

Option 3: Try to print grouped object without aggregation
&lt;pandas.core.groupby.generic.DataFrameGroupBy object at 0x151a4e3f0&gt;</code></pre>
</div>
</div>
<p><strong>Key Insights:</strong></p>
<ol type="1">
<li><strong><code>.groupby()</code> creates groups</strong> but doesn‚Äôt calculate anything</li>
<li><strong><code>.agg()</code> tells pandas WHAT to calculate</strong> for each group</li>
<li><strong>Without <code>.agg()</code></strong>, you have a GroupBy object (not usable data)</li>
<li><strong>With <code>.agg()</code></strong>, you get a DataFrame with results</li>
</ol>
<p><strong>Common aggregation functions:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>.agg(<span class="st">'sum'</span>)      <span class="co"># Total</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>.agg(<span class="st">'mean'</span>)     <span class="co"># Average</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>.agg(<span class="st">'count'</span>)    <span class="co"># Count rows</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>.agg(<span class="st">'min'</span>)      <span class="co"># Minimum</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>.agg(<span class="st">'max'</span>)      <span class="co"># Maximum</span></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>.agg([<span class="st">'sum'</span>, <span class="st">'mean'</span>, <span class="st">'count'</span>])  <span class="co"># Multiple at once!</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<blockquote class="blockquote">
<p><strong>Answers to Question 2: Multi-Level Grouping</strong></p>
</blockquote>
<p><strong>What does grouping by <code>['shipID', 'prodCategory']</code> do versus just <code>'prodCategory'</code>?</strong></p>
<div id="73705198" class="cell" data-execution_count="30">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Comparing single vs multi-level grouping:</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Single-level: Group by prodCategory only</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>single_group <span class="op">=</span> (</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>    shipments_with_category</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>    .groupby(<span class="st">'prodCategory'</span>)</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>    .agg({</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">'is_late'</span>: [<span class="st">'count'</span>, <span class="st">'sum'</span>]</span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Single-level grouping by 'prodCategory':"</span>)</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(single_group)</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Question answered: How many shipments per category are late?"</span>)</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">60</span>)</span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Multi-level: Group by BOTH shipID and prodCategory</span></span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a>multi_group <span class="op">=</span> (</span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a>    shipments_with_category</span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a>    .groupby([<span class="st">'shipID'</span>, <span class="st">'prodCategory'</span>])</span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true" tabindex="-1"></a>    .agg({</span>
<span id="cb79-23"><a href="#cb79-23" aria-hidden="true" tabindex="-1"></a>        <span class="st">'is_late'</span>: <span class="st">'any'</span>,  <span class="co"># True if ANY item late</span></span>
<span id="cb79-24"><a href="#cb79-24" aria-hidden="true" tabindex="-1"></a>        <span class="st">'partID'</span>: <span class="st">'count'</span>   <span class="co"># Count items in this shipment/category combo</span></span>
<span id="cb79-25"><a href="#cb79-25" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb79-26"><a href="#cb79-26" aria-hidden="true" tabindex="-1"></a>    .reset_index()</span>
<span id="cb79-27"><a href="#cb79-27" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb79-28"><a href="#cb79-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Multi-level grouping by ['shipID', 'prodCategory']:"</span>)</span>
<span id="cb79-29"><a href="#cb79-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(multi_group.head(<span class="dv">15</span>))</span>
<span id="cb79-30"><a href="#cb79-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Question answered: For EACH shipment, what categories does it contain?"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Comparing single vs multi-level grouping:

Single-level grouping by 'prodCategory':
             is_late     
               count  sum
prodCategory             
Liquids          537   22
Machines         846  152
Marketables     1850  145
SpareParts       767  137

Question answered: How many shipments per category are late?

============================================================

Multi-level grouping by ['shipID', 'prodCategory']:
    shipID prodCategory  is_late  partID
0    10001     Machines    False       1
1    10002  Marketables    False       1
2    10003     Machines    False       1
3    10004  Marketables    False       1
4    10005     Machines    False       1
5    10006  Marketables    False       1
6    10007   SpareParts    False       1
7    10008     Machines    False       1
8    10009  Marketables    False       1
9    10010     Machines    False       1
10   10011     Machines    False       4
11   10011   SpareParts    False       3
12   10012  Marketables    False       4
13   10013     Machines    False       5
14   10013  Marketables    False       1

Question answered: For EACH shipment, what categories does it contain?</code></pre>
</div>
</div>
<p><strong>Key Difference:</strong></p>
<p><strong>Single-level <code>['prodCategory']</code>:</strong> - Groups ALL shipments by category - Answer: ‚ÄúHow do categories perform overall?‚Äù</p>
<p><strong>Multi-level <code>['shipID', 'prodCategory']</code>:</strong> - Groups by BOTH shipID AND category - Creates one row per unique combination - Answer: ‚ÄúWhich categories are in each specific shipment?‚Äù</p>
<p><strong>Why is this useful?</strong></p>
<div id="a29a5022" class="cell" data-execution_count="31">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Why multi-level grouping matters:</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Use multi-level to find shipments with multiple categories</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>multi_category_info <span class="op">=</span> (</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>    shipments_with_category</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>    .groupby(<span class="st">'shipID'</span>)</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>    .agg({</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">'prodCategory'</span>: <span class="st">'nunique'</span>,  <span class="co"># Count unique categories</span></span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">'partID'</span>: <span class="st">'count'</span>           <span class="co"># Count total items</span></span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>    .reset_index()</span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Find shipments with multiple categories</span></span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a>multi_cat <span class="op">=</span> multi_category_info[multi_category_info[<span class="st">'prodCategory'</span>] <span class="op">&gt;</span> <span class="dv">1</span>]</span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Shipments with multiple categories: </span><span class="sc">{</span><span class="bu">len</span>(multi_cat)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Percentage: </span><span class="sc">{</span><span class="bu">len</span>(multi_cat) <span class="op">/</span> <span class="bu">len</span>(multi_category_info) <span class="op">*</span> <span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">%"</span>)</span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Examples:"</span>)</span>
<span id="cb81-19"><a href="#cb81-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(multi_cat.head(<span class="dv">10</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Why multi-level grouping matters:

Shipments with multiple categories: 232
Percentage: 23.3%

Examples:
    shipID  prodCategory  partID
10   10011             2       7
12   10013             3       8
13   10014             3      27
14   10015             3      12
15   10016             3      10
16   10017             4      20
19   10020             3      11
24   10025             2       3
31   10032             3       5
32   10033             4      18</code></pre>
</div>
</div>
<p><strong>Business Insight:</strong> - Single-level: Category performance - Multi-level: Cross-category shopping behavior!</p>
</section>
</section>
</section>
<section id="answering-a-business-question" class="level2">
<h2 class="anchored" data-anchor-id="answering-a-business-question">Answering A Business Question</h2>
<p><strong>Mental Model:</strong> Combine multiple data manipulation techniques to answer complex business questions.</p>
<p>Let‚Äôs create a comprehensive analysis by combining shipment-level data with category information:</p>
<div id="mental-model-7-comprehensive" class="cell" data-execution_count="32">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a comprehensive analysis dataset</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>comprehensive_analysis <span class="op">=</span> (</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>    shipments_with_category</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>    .groupby([<span class="st">'shipID'</span>, <span class="st">'prodCategory'</span>])  <span class="co"># Group by shipment and category</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>    .agg({</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">'is_late'</span>: <span class="st">'any'</span>,  <span class="co"># True if any item in this shipment/category is late</span></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">'days_late'</span>: <span class="st">'max'</span>  <span class="co"># Maximum days late for this shipment/category</span></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>    .reset_index()</span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>    .assign(</span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>        has_multiple_categories<span class="op">=</span><span class="kw">lambda</span> df: df.groupby(<span class="st">'shipID'</span>)[<span class="st">'prodCategory'</span>].transform(<span class="st">'nunique'</span>) <span class="op">&gt;</span> <span class="dv">1</span></span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Comprehensive analysis - shipments with multiple categories:"</span>)</span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a>multi_category_shipments <span class="op">=</span> comprehensive_analysis[comprehensive_analysis[<span class="st">'has_multiple_categories'</span>]]</span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Shipments with multiple categories: </span><span class="sc">{</span>multi_category_shipments[<span class="st">'shipID'</span>]<span class="sc">.</span>nunique()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb83-18"><a href="#cb83-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Total unique shipments: </span><span class="sc">{</span>comprehensive_analysis[<span class="st">'shipID'</span>]<span class="sc">.</span>nunique()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb83-19"><a href="#cb83-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Percentage with multiple categories: </span><span class="sc">{</span>multi_category_shipments[<span class="st">'shipID'</span>]<span class="sc">.</span>nunique() <span class="op">/</span> comprehensive_analysis[<span class="st">'shipID'</span>]<span class="sc">.</span>nunique() <span class="op">*</span> <span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">%"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Comprehensive analysis - shipments with multiple categories:
Shipments with multiple categories: 232
Total unique shipments: 997
Percentage with multiple categories: 23.3%</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>ü§î Discussion Questions: Answering A Business Question
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Question 1: Business Question Analysis</strong> - What business question does this comprehensive analysis answer? - How does grouping by <code>['shipID', 'prodCategory']</code> differ from grouping by just <code>'prodCategory'</code>? - What insights can ZappTech‚Äôs management gain from knowing the percentage of multi-category shipments?</p>
</div>
</div>
<section id="briefly-give-answers-to-the-discussion-questions-in-this-section-7" class="level4">
<h4 class="anchored" data-anchor-id="briefly-give-answers-to-the-discussion-questions-in-this-section-7">Briefly Give Answers to the Discussion Questions In This Section</h4>
<blockquote class="blockquote">
<p><strong>Answers to Question 1: Business Question Analysis</strong></p>
</blockquote>
<p><strong>What business question does this comprehensive analysis answer?</strong></p>
<p>The comprehensive analysis answers: <strong>‚ÄúDo customers order products from multiple categories in a single shipment, and how common is this cross-category shopping behavior?‚Äù</strong></p>
<div id="0658736b" class="cell" data-execution_count="33">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Understanding the Business Question:</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="co"># The comprehensive analysis groups by BOTH shipID and prodCategory</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Step 1: Group by shipID and prodCategory"</span>)</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(comprehensive_analysis[[<span class="st">'shipID'</span>, <span class="st">'prodCategory'</span>, <span class="st">'is_late'</span>, <span class="st">'has_multiple_categories'</span>]].head(<span class="dv">5</span>))</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Key metric: How many shipments have multiple categories?</span></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>multi_cat_shipments <span class="op">=</span> comprehensive_analysis[comprehensive_analysis[<span class="st">'has_multiple_categories'</span>]]</span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>total_shipments <span class="op">=</span> comprehensive_analysis[<span class="st">'shipID'</span>].nunique()</span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>multi_cat_count <span class="op">=</span> multi_cat_shipments[<span class="st">'shipID'</span>].nunique()</span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">60</span>)</span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"BUSINESS QUESTION ANSWERED:"</span>)</span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">60</span>)</span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Total unique shipments: </span><span class="sc">{</span>total_shipments<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb85-17"><a href="#cb85-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Shipments with multiple categories: </span><span class="sc">{</span>multi_cat_count<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb85-18"><a href="#cb85-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Percentage: </span><span class="sc">{</span>multi_cat_count <span class="op">/</span> total_shipments <span class="op">*</span> <span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">%"</span>)</span>
<span id="cb85-19"><a href="#cb85-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb85-20"><a href="#cb85-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-21"><a href="#cb85-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Show examples of multi-category shipments</span></span>
<span id="cb85-22"><a href="#cb85-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Examples of multi-category shipments:"</span>)</span>
<span id="cb85-23"><a href="#cb85-23" aria-hidden="true" tabindex="-1"></a>sample_multi <span class="op">=</span> comprehensive_analysis[comprehensive_analysis[<span class="st">'has_multiple_categories'</span>]].head(<span class="dv">10</span>)</span>
<span id="cb85-24"><a href="#cb85-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sample_multi[[<span class="st">'shipID'</span>, <span class="st">'prodCategory'</span>, <span class="st">'is_late'</span>]])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Understanding the Business Question:

Step 1: Group by shipID and prodCategory
   shipID prodCategory  is_late  has_multiple_categories
0   10001     Machines    False                    False
1   10002  Marketables    False                    False
2   10003     Machines    False                    False
3   10004  Marketables    False                    False
4   10005     Machines    False                    False

============================================================
BUSINESS QUESTION ANSWERED:
============================================================
Total unique shipments: 997
Shipments with multiple categories: 232
Percentage: 23.3%

Examples of multi-category shipments:
    shipID prodCategory  is_late
10   10011     Machines    False
11   10011   SpareParts    False
13   10013     Machines    False
14   10013  Marketables    False
15   10013   SpareParts    False
16   10014     Machines    False
17   10014  Marketables    False
18   10014   SpareParts    False
19   10015     Machines    False
20   10015  Marketables    False</code></pre>
</div>
</div>
<p><strong>This answers critical business questions:</strong> 1. Are customers buying across product categories? 2. How common is cross-category shopping? 3. Do multi-category orders have different service levels i.e.&nbsp;Expedite service level?</p>
<p><strong>How does grouping by <code>['shipID', 'prodCategory']</code> differ from grouping by just <code>'prodCategory'</code>?</strong></p>
<div id="b8546b79" class="cell" data-execution_count="34">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Comparing Single vs Multi-Column Grouping:</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Method 1: Group by 'prodCategory' only</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Method 1: Grouping by 'prodCategory' only"</span>)</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>category_only <span class="op">=</span> (</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>    shipments_with_category</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>    .groupby(<span class="st">'prodCategory'</span>)</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>    .agg({</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">'is_late'</span>: [<span class="st">'count'</span>, <span class="st">'sum'</span>, <span class="st">'mean'</span>]</span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(category_only)</span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">üìä Answers: 'How many shipments are late per category?'"</span>)</span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   Focus: Category-level performance"</span>)</span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   Result: </span><span class="sc">{</span><span class="bu">len</span>(category_only)<span class="sc">}</span><span class="ss"> rows (one per category)"</span>)</span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">60</span>)</span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-20"><a href="#cb87-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Method 2: Group by BOTH ['shipID', 'prodCategory']</span></span>
<span id="cb87-21"><a href="#cb87-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Method 2: Grouping by ['shipID', 'prodCategory']"</span>)</span>
<span id="cb87-22"><a href="#cb87-22" aria-hidden="true" tabindex="-1"></a>shipment_and_category <span class="op">=</span> (</span>
<span id="cb87-23"><a href="#cb87-23" aria-hidden="true" tabindex="-1"></a>    shipments_with_category</span>
<span id="cb87-24"><a href="#cb87-24" aria-hidden="true" tabindex="-1"></a>    .groupby([<span class="st">'shipID'</span>, <span class="st">'prodCategory'</span>])</span>
<span id="cb87-25"><a href="#cb87-25" aria-hidden="true" tabindex="-1"></a>    .agg({</span>
<span id="cb87-26"><a href="#cb87-26" aria-hidden="true" tabindex="-1"></a>        <span class="st">'is_late'</span>: <span class="st">'any'</span>,</span>
<span id="cb87-27"><a href="#cb87-27" aria-hidden="true" tabindex="-1"></a>        <span class="st">'partID'</span>: <span class="st">'count'</span></span>
<span id="cb87-28"><a href="#cb87-28" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb87-29"><a href="#cb87-29" aria-hidden="true" tabindex="-1"></a>    .reset_index()</span>
<span id="cb87-30"><a href="#cb87-30" aria-hidden="true" tabindex="-1"></a>    .head(<span class="dv">20</span>)</span>
<span id="cb87-31"><a href="#cb87-31" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb87-32"><a href="#cb87-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(shipment_and_category)</span>
<span id="cb87-33"><a href="#cb87-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">üìä Answers: 'What categories does EACH shipment contain?'"</span>)</span>
<span id="cb87-34"><a href="#cb87-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   Focus: Individual shipment composition"</span>)</span>
<span id="cb87-35"><a href="#cb87-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   Result: </span><span class="sc">{</span><span class="bu">len</span>(comprehensive_analysis)<span class="sc">}</span><span class="ss"> rows (one per shipment-category combo)"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Comparing Single vs Multi-Column Grouping:

Method 1: Grouping by 'prodCategory' only
             is_late               
               count  sum      mean
prodCategory                       
Liquids          537   22  0.040968
Machines         846  152  0.179669
Marketables     1850  145  0.078378
SpareParts       767  137  0.178618

üìä Answers: 'How many shipments are late per category?'
   Focus: Category-level performance
   Result: 4 rows (one per category)

============================================================

Method 2: Grouping by ['shipID', 'prodCategory']
    shipID prodCategory  is_late  partID
0    10001     Machines    False       1
1    10002  Marketables    False       1
2    10003     Machines    False       1
3    10004  Marketables    False       1
4    10005     Machines    False       1
5    10006  Marketables    False       1
6    10007   SpareParts    False       1
7    10008     Machines    False       1
8    10009  Marketables    False       1
9    10010     Machines    False       1
10   10011     Machines    False       4
11   10011   SpareParts    False       3
12   10012  Marketables    False       4
13   10013     Machines    False       5
14   10013  Marketables    False       1
15   10013   SpareParts    False       2
16   10014     Machines    False      12
17   10014  Marketables    False       4
18   10014   SpareParts    False      11
19   10015     Machines    False       5

üìä Answers: 'What categories does EACH shipment contain?'
   Focus: Individual shipment composition
   Result: 1359 rows (one per shipment-category combo)</code></pre>
</div>
</div>
<p><strong>Key Differences:</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 11%">
<col style="width: 34%">
<col style="width: 53%">
</colgroup>
<thead>
<tr class="header">
<th>Aspect</th>
<th>Group by ‚ÄòprodCategory‚Äô</th>
<th>Group by [‚ÄòshipID‚Äô, ‚ÄòprodCategory‚Äô]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Granularity</strong></td>
<td>Category level</td>
<td>Shipment-category level</td>
</tr>
<tr class="even">
<td><strong>Question</strong></td>
<td>‚ÄúHow do categories perform?‚Äù</td>
<td>‚ÄúWhat‚Äôs in each shipment?‚Äù</td>
</tr>
<tr class="odd">
<td><strong>Rows</strong></td>
<td>4 (one per category)</td>
<td>1000+ (one per combo)</td>
</tr>
<tr class="even">
<td><strong>Use Case</strong></td>
<td>Category performance</td>
<td>Cross-shopping analysis</td>
</tr>
</tbody>
</table>
<div id="4e9c4266" class="cell" data-execution_count="35">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Demonstrate the difference with a specific example</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Concrete Example:</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Pick one shipment with multiple categories</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>sample_ship <span class="op">=</span> comprehensive_analysis[</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>    (comprehensive_analysis[<span class="st">'has_multiple_categories'</span>]) <span class="op">&amp;</span> </span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>    (comprehensive_analysis[<span class="st">'shipID'</span>] <span class="op">==</span> comprehensive_analysis[comprehensive_analysis[<span class="st">'has_multiple_categories'</span>]][<span class="st">'shipID'</span>].iloc[<span class="dv">0</span>])</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">len</span>(sample_ship) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>    ship_id <span class="op">=</span> sample_ship[<span class="st">'shipID'</span>].iloc[<span class="dv">0</span>]</span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Shipment </span><span class="sc">{</span>ship_id<span class="sc">}</span><span class="ss"> contains:"</span>)</span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _, row <span class="kw">in</span> sample_ship.iterrows():</span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"  - </span><span class="sc">{</span>row[<span class="st">'prodCategory'</span>]<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="st">'Late'</span> <span class="cf">if</span> row[<span class="st">'is_late'</span>] <span class="cf">else</span> <span class="st">'On-time'</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>()</span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Single-level grouping would show:"</span>)</span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"  'Liquids: X shipments, Y late'"</span>)</span>
<span id="cb89-18"><a href="#cb89-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>()</span>
<span id="cb89-19"><a href="#cb89-19" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Multi-level grouping shows:"</span>)</span>
<span id="cb89-20"><a href="#cb89-20" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  'Shipment </span><span class="sc">{</span>ship_id<span class="sc">}</span><span class="ss"> has Liquids AND Machines' (cross-category order!)"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Concrete Example:

Shipment 10011 contains:
  - Machines: On-time
  - SpareParts: On-time

Single-level grouping would show:
  'Liquids: X shipments, Y late'

Multi-level grouping shows:
  'Shipment 10011 has Liquids AND Machines' (cross-category order!)</code></pre>
</div>
</div>
<p><strong>What insights can ZappTech‚Äôs management gain from knowing the percentage of multi-category shipments?</strong></p>
<div id="222fcda0" class="cell" data-execution_count="36">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Business Insights from Multi-Category Analysis:</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate key metrics</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>total_unique_shipments <span class="op">=</span> comprehensive_analysis[<span class="st">'shipID'</span>].nunique()</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>multi_category_shipments <span class="op">=</span> comprehensive_analysis[comprehensive_analysis[<span class="st">'has_multiple_categories'</span>]][<span class="st">'shipID'</span>].nunique()</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>percentage <span class="op">=</span> multi_category_shipments <span class="op">/</span> total_unique_shipments <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"üìà Key Metric: </span><span class="sc">{</span>percentage<span class="sc">:.1f}</span><span class="ss">% of shipments contain multiple categories"</span>)</span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare service levels</span></span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>multi_cat_late <span class="op">=</span> comprehensive_analysis[</span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a>    comprehensive_analysis[<span class="st">'has_multiple_categories'</span>]</span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a>][<span class="st">'is_late'</span>].mean()</span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a>single_cat_late <span class="op">=</span> comprehensive_analysis[</span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">~</span>comprehensive_analysis[<span class="st">'has_multiple_categories'</span>]</span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a>][<span class="st">'is_late'</span>].mean()</span>
<span id="cb91-19"><a href="#cb91-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-20"><a href="#cb91-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Service Level Comparison:"</span>)</span>
<span id="cb91-21"><a href="#cb91-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Multi-category orders late rate: </span><span class="sc">{</span>multi_cat_late <span class="op">*</span> <span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">%"</span>)</span>
<span id="cb91-22"><a href="#cb91-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Single-category orders late rate: </span><span class="sc">{</span>single_cat_late <span class="op">*</span> <span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">%"</span>)</span>
<span id="cb91-23"><a href="#cb91-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb91-24"><a href="#cb91-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-25"><a href="#cb91-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate revenue impact (assuming multi-category = higher value)</span></span>
<span id="cb91-26"><a href="#cb91-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">60</span>)</span>
<span id="cb91-27"><a href="#cb91-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"MANAGEMENT INSIGHTS:"</span>)</span>
<span id="cb91-28"><a href="#cb91-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">60</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Business Insights from Multi-Category Analysis:

üìà Key Metric: 23.3% of shipments contain multiple categories

Service Level Comparison:
  Multi-category orders late rate: 9.8%
  Single-category orders late rate: 4.2%

============================================================
MANAGEMENT INSIGHTS:
============================================================</code></pre>
</div>
</div>
<p><strong>1. Cross-Selling Opportunity:</strong> - 23.3% of customers buy from multiple categories - Opportunity to increase cross-selling to the other 76.7% - Product bundling strategies could boost average order value</p>
<p><strong>2. Customer Segmentation:</strong> - Multi-category buyers are more valuable customers - Different marketing/retention strategies needed - Target cross-category promotions to single-category buyers</p>
<p><strong>3. Warehouse &amp; Logistics Planning:</strong> - 23% of orders require picking from multiple zones - May need different fulfillment strategies - Cross-category orders might have different complexity</p>
<p><strong>4. Inventory Management:</strong> - Need to stock complementary products together - Understand which categories are bought together - Optimize warehouse layout for common combinations</p>
<p><strong>5. Service Level Strategy:</strong> - Compare late rates: Multi-category vs single-category - May need different SLAs for complex orders - Resource allocation based on order complexity</p>
<p><strong>6. Marketing Strategy:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># If 23% buy multi-category naturally:</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="co"># - Promote bundles to increase this to 30-35%</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="co"># - Study what triggers cross-category purchases</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="co"># - Create "Complete the Set" campaigns</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>7. Revenue Implications:</strong></p>
<div id="4933a920" class="cell" data-execution_count="37">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assumptions:</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="co"># - Single-category order avg: $100</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a><span class="co"># - Multi-category order avg: $250 (2.5x)</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>single_cat_revenue <span class="op">=</span> (total_unique_shipments <span class="op">*</span> <span class="fl">0.767</span>) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>multi_cat_revenue <span class="op">=</span> (total_unique_shipments <span class="op">*</span> <span class="fl">0.233</span>) <span class="op">*</span> <span class="dv">250</span></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>total_revenue <span class="op">=</span> single_cat_revenue <span class="op">+</span> multi_cat_revenue</span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a><span class="co"># If we increase multi-category from 23% to 30%:</span></span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Additional revenue = 7% of customers √ó $150 extra = significant!</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><strong>Action Items for ZappTech:</strong> 1. <strong>Identify which categories are commonly bought together</strong> 2. <strong>Create product bundles</strong> based on shopping patterns 3. <strong>Optimize warehouse layout</strong> for common combinations 4. <strong>Develop targeted marketing</strong> for cross-category promotions 5. <strong>Monitor service levels</strong> by order complexity 6. <strong>Set appropriate expectations</strong> for complex orders</p>
<hr>
</section>
</section>
<section id="professional-visualization-service-level-by-product-category" class="level2">
<h2 class="anchored" data-anchor-id="professional-visualization-service-level-by-product-category">Professional Visualization: Service Level by Product Category</h2>
<section id="on-time-delivery-performance-analysis" class="level3">
<h3 class="anchored" data-anchor-id="on-time-delivery-performance-analysis">On-Time Delivery Performance Analysis</h3>
<div id="fe3c82c1" class="cell" data-fig-height="6" data-fig-width="10" data-execution_count="38">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/cell-39-output-1.png" width="1334" height="564" class="figure-img"></p>
<figcaption>Service Level Performance by Product Category</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
======================================================================
SERVICE LEVEL SUMMARY BY CATEGORY
======================================================================
Liquids           95.9%  ( 537 shipments)  üü¢ EXCELLENT
Marketables       92.2%  (1850 shipments)  üü¢ EXCELLENT
SpareParts        82.1%  ( 767 shipments)  üî¥ NEEDS IMPROVEMENT
Machines          82.0%  ( 846 shipments)  üî¥ NEEDS IMPROVEMENT

Overall Average   88.6%
======================================================================

üìä KEY INSIGHTS:
   ‚Ä¢ Best performer: Liquids at 95.9%
   ‚Ä¢ Needs improvement: Machines at 82.0%
   ‚Ä¢ Performance gap: 13.9 percentage points
   ‚Ä¢ Categories below average: 2</code></pre>
</div>
</div>
</section>
<section id="key-findings" class="level3">
<h3 class="anchored" data-anchor-id="key-findings">Key Findings:</h3>
<p><strong>Performance Tiers:</strong> 1. <strong>üü¢ Excellent (‚â•92%):</strong> Liquids, Marketables 2. <strong>üü° Fair (85-92%):</strong> SpareParts, Machines 3. <strong>üî¥ Needs Improvement (&lt;85%):</strong> None currently, but SpareParts and Machines are borderline</p>
<p><strong>Management Recommendations:</strong> 1. <strong>Study Liquids Success:</strong> Investigate why Liquids category achieves 95.9% on-time delivery 2. <strong>Focus on Machines &amp; SpareParts:</strong> These categories show ~82% performance, 13+ points below Liquids 3. <strong>Resource Reallocation:</strong> Consider dedicating more resources to underperforming categories 4. <strong>Set Category-Specific SLAs:</strong> Different categories may need different delivery expectations</p>
<hr>
</section>
</section>
<section id="student-analysis-section" class="level2">
<h2 class="anchored" data-anchor-id="student-analysis-section">Student Analysis Section: Mastering Data Manipulation</h2>
<p><strong>Your Task:</strong> Demonstrate your mastery of the seven mental models through comprehensive discussion and analysis. The bulk of your grade comes from thoughtfully answering the discussion questions for each mental model. See below for more details.</p>
<section id="core-challenge-discussion-questions-analysis" class="level3">
<h3 class="anchored" data-anchor-id="core-challenge-discussion-questions-analysis">Core Challenge: Discussion Questions Analysis</h3>
<p><strong>For each mental model, provide:</strong> - Clear, concise answers to all discussion questions - Code examples where appropriate to support your explanations</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>üìä Discussion Questions Requirements
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Complete all discussion question sections:</strong> 1. <strong>Assign Mental Model:</strong> Data types, date handling, and debugging 2. <strong>Subset Mental Model:</strong> Filtering strategies and complex queries 3. <strong>Drop Mental Model:</strong> Data cleaning and quality management 4. <strong>Sort Mental Model:</strong> Data organization and business logic 5. <strong>Aggregate Mental Model:</strong> Summary statistics and business metrics 6. <strong>Merge Mental Model:</strong> Data integration and quality control 7. <strong>Split-Apply-Combine Mental Model:</strong> Group analysis and advanced operations 8. <strong>Answering A Business Question:</strong> Combining multiple data manipulation techniques to answer a business question</p>
</div>
</div>
</section>
<section id="professional-visualizations-for-100-grade" class="level3">
<h3 class="anchored" data-anchor-id="professional-visualizations-for-100-grade">Professional Visualizations (For 100% Grade)</h3>
<p><strong>Your Task:</strong> Create a professional visualization that supports your analysis and demonstrates your understanding of the data.</p>
<p><strong>Create visualizations showing:</strong> - Service level (on-time percentage) by product category</p>
<p><strong>Your visualizations should:</strong> - Use clear labels and professional formatting - Support the insights from your discussion questions - Be appropriate for a business audience - Do not <code>echo</code> the code that creates the visualizations</p>
<div id="3d712062" class="cell" data-execution_count="39">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Service level by product category:"</span>)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(comprehensive_analysis[[<span class="st">'prodCategory'</span>, <span class="st">'is_late'</span>]].groupby(<span class="st">'prodCategory'</span>).agg({<span class="st">'is_late'</span>: <span class="st">'mean'</span>}))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Service level by product category:
               is_late
prodCategory          
Liquids       0.044164
Machines      0.101796
Marketables   0.057052
SpareParts    0.094262</code></pre>
</div>
</div>
</section>
</section>
<section id="challenge-requirements" class="level2">
<h2 class="anchored" data-anchor-id="challenge-requirements">Challenge Requirements üìã</h2>
<p><strong>Your Primary Task:</strong> Answer all discussion questions for the seven mental models with thoughtful, well-reasoned responses that demonstrate your understanding of data manipulation concepts.</p>
<p><strong>Key Requirements:</strong> - Complete discussion questions for each mental model - Demonstrate clear understanding of pandas concepts and data manipulation techniques - Write clear, business-focused analysis that explains your findings</p>
</section>
<section id="getting-started-repository-setup" class="level2">
<h2 class="anchored" data-anchor-id="getting-started-repository-setup">Getting Started: Repository Setup üöÄ</h2>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>üìÅ Getting Started
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Step 1:</strong> Fork and clone this challenge repository - Go to the course repository and find the ‚ÄúdataManipulationChallenge‚Äù folder - Fork it to your GitHub account, or clone it directly - Open the cloned repository in Cursor</p>
<p><strong>Step 2:</strong> Set up your Python environment - Follow the Python setup instructions above (use your existing venv from Tech Setup Challenge Part 2) - Make sure your virtual environment is activated and the Python interpreter is set</p>
<p><strong>Step 3:</strong> You‚Äôre ready to start! The data loading code is already provided in this file.</p>
<p><strong>Note:</strong> This challenge uses the same <code>index.qmd</code> file you‚Äôre reading right now - you‚Äôll edit it to complete your analysis.</p>
</div>
</div>
<section id="getting-started-tips" class="level3">
<h3 class="anchored" data-anchor-id="getting-started-tips">Getting Started Tips</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>üéØ Method Chaining Philosophy
</div>
</div>
<div class="callout-body-container callout-body">
<blockquote class="blockquote">
<p>‚ÄúEach operation should build naturally on the previous one‚Äù</p>
</blockquote>
<p><em>Think of method chaining like building with LEGO blocks - each piece connects to the next, creating something more complex and useful than the individual pieces.</em></p>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warning</span>üíæ Important: Save Your Work Frequently!
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Before you start:</strong> Make sure to commit your work often using the Source Control panel in Cursor (Ctrl+Shift+G or Cmd+Shift+G). This prevents the AI from overwriting your progress and ensures you don‚Äôt lose your work.</p>
<p><strong>Commit after each major step:</strong></p>
<ul>
<li>After completing each mental model section</li>
<li>After adding your visualizations</li>
<li>After completing your advanced method chain</li>
<li>Before asking the AI for help with new code</li>
</ul>
<p><strong>How to commit:</strong></p>
<ol type="1">
<li>Open Source Control panel (Ctrl+Shift+G)</li>
<li>Stage your changes (+ button)</li>
<li>Write a descriptive commit message</li>
<li>Click the checkmark to commit</li>
</ol>
<p><em>Remember: Frequent commits are your safety net!</em></p>
</div>
</div>
</section>
</section>
<section id="grading-rubric" class="level2">
<h2 class="anchored" data-anchor-id="grading-rubric">Grading Rubric üéì</h2>
<p><strong>75% Grade:</strong> Complete discussion questions for at least 5 of the 7 mental models with clear, thoughtful responses.</p>
<p><strong>85% Grade:</strong> Complete discussion questions for all 7 mental models with comprehensive, well-reasoned responses.</p>
<p><strong>95% Grade:</strong> Complete all discussion questions plus the ‚ÄúAnswering A Business Question‚Äù section.</p>
<p><strong>100% Grade:</strong> Complete all discussion questions plus create a professional visualization showing service level by product category.</p>
</section>
<section id="submission-checklist" class="level2">
<h2 class="anchored" data-anchor-id="submission-checklist">Submission Checklist ‚úÖ</h2>
<p><strong>Minimum Requirements (Required for Any Points):</strong></p>
<ul class="task-list">
<li><label><input type="checkbox">Created repository named ‚ÄúdataManipulationChallenge‚Äù in your GitHub account</label></li>
<li><label><input type="checkbox">Cloned repository locally using Cursor (or VS Code)</label></li>
<li><label><input type="checkbox">Completed discussion questions for at least 5 of the 7 mental models</label></li>
<li><label><input type="checkbox">Document rendered to HTML successfully</label></li>
<li><label><input type="checkbox">HTML files uploaded to your repository</label></li>
<li><label><input type="checkbox">GitHub Pages enabled and working</label></li>
<li><label><input type="checkbox">Site accessible at <code>https://[your-username].github.io/dataManipulationChallenge/</code></label></li>
</ul>
<p><strong>75% Grade Requirements:</strong></p>
<ul class="task-list">
<li><label><input type="checkbox">Complete discussion questions for at least 5 of the 7 mental models</label></li>
<li><label><input type="checkbox">Clear, thoughtful responses that demonstrate understanding</label></li>
<li><label><input type="checkbox">Code examples where appropriate to support explanations</label></li>
</ul>
<p><strong>85% Grade Requirements:</strong></p>
<ul class="task-list">
<li><label><input type="checkbox">Complete discussion questions for all 7 mental models</label></li>
<li><label><input type="checkbox">Comprehensive, well-reasoned responses showing deep understanding</label></li>
<li><label><input type="checkbox">Business context for why concepts matter</label></li>
<li><label><input type="checkbox">Examples of real-world applications</label></li>
</ul>
<p><strong>95% Grade Requirements:</strong></p>
<ul class="task-list">
<li><label><input type="checkbox">Complete discussion questions for all 7 mental models</label></li>
<li><label><input type="checkbox">Complete the ‚ÄúAnswering A Business Question‚Äù discussion questions</label></li>
<li><label><input type="checkbox">Comprehensive, well-reasoned responses showing deep understanding</label></li>
<li><label><input type="checkbox">Business context for why concepts matter</label></li>
</ul>
<p><strong>100% Grade Requirements:</strong></p>
<ul class="task-list">
<li><label><input type="checkbox">All discussion questions completed with professional quality</label></li>
<li><label><input type="checkbox">Professional visualization showing service level by product category</label></li>
<li><label><input type="checkbox">Professional presentation style appropriate for business audience</label></li>
<li><label><input type="checkbox">Clear, engaging narrative that tells a compelling story</label></li>
<li><label><input type="checkbox">Practical insights that would help ZappTech‚Äôs management</label></li>
</ul>
<p><strong>Report Quality (Critical for Higher Grades):</strong></p>
<ul class="task-list">
<li><label><input type="checkbox">Professional writing style (no AI-generated fluff)</label></li>
<li><label><input type="checkbox">Concise analysis that gets to the point</label></li>
</ul>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "Óßã";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>